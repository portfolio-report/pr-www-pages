import{aj as k,ak as x,al as Q,w as _,n as g}from"./DtstXNPz.js";import{t as j,a as y}from"./CRo4fNna.js";const i=new WeakMap;function b(o,n,f={}){const{mode:q="replace",route:a=k(),router:s=x(),transform:l=t=>t}=f;i.has(s)||i.set(s,new Map);const u=i.get(s);let e=a.query[o];j(()=>{e=void 0});let c;const m=Q((t,p)=>(c=p,{get(){return t(),l(e!==void 0?e:y(n))},set(r){e!==r&&(e=r===n||r===null?void 0:r,u.set(o,r===n||r===null?void 0:r),p(),g(()=>{if(u.size===0)return;const h=Object.fromEntries(u.entries());u.clear();const{params:w,query:R,hash:d}=a;s[y(q)]({params:w,query:{...R,...h},hash:d})}))}}));return _(()=>a.query[o],t=>{e!==t&&(e=t,c())},{flush:"sync"}),m}export{b as u};
