import{d as A,r as p,o,c as u,a as m,b as e,u as E,D as L,E as Q,h as d,j as W,w as l,F as f,G as x,H as J,A as z,e as t,t as h,I as V,J as I,K as R,_ as O}from"./entry.85781658.js";import{_ as Z}from"./SecurityTag.dc2ed42c.js";import{u as ee}from"./useApi.77cf1646.js";import"./_plugin-vue_export-helper.a1a6add7.js";const te={class:"p-float-label"},oe=e("label",{for:"dropdown"},"Security Type",-1),se=A({__name:"SelectSecurityType",props:{modelValue:null},emits:["update:modelValue"],setup(P,{emit:c}){const S=[{text:"*",value:""},{text:"share",value:"share"},{text:"fund",value:"fund"},{text:"bond",value:"bond"},{text:"index",value:"index"}];function i(r){c("update:modelValue",r)}return(r,v)=>{const _=p("Dropdown");return o(),u("span",te,[m(_,{id:"dropdown",class:"w-full","model-value":P.modelValue,options:S,"option-label":"text","option-value":"value","show-clear":!0,"onUpdate:modelValue":i},null,8,["model-value"]),oe])}}}),ne={class:"flex justify-content-center"},ae={style:{width:"800px"}},le=t("Security Search"),re=["onSubmit"],ue={class:"p-float-label mt-2"},ie=e("label",{for:"searchTermInput"},"ISIN/WKN/Symbol/Name",-1),ce={key:0,class:"font-bold"},de=t(" Sorry, no results were found. "),pe=t(" Sorry, there was an error:"),me=e("br",null,null,-1),_e=t("Results"),fe={class:"text-lg font-medium flex align-items-center"},he={key:0,class:"i-carbon-chart-line mr-1"},ve=t(" ISIN: "),ye=t(" | WKN: "),be=t(" | Symbol(s): "),xe={key:0},we=t("Your contribution is needed \u{1F4AA}"),Se=t(" Your help is needed to keep this website up and running. Have you thought about contributing? You could: "),ge=e("ul",null,[e("li",null,[t(" Actively maintain and develop the "),e("a",{href:"https://www.github.com/portfolio-report"},"source code on Github"),t(". ")]),e("li",null,[t(" Become member of the "),e("a",{href:"https://forum.portfolio-performance.info"},"forum"),t(" and help other users. ")]),e("li",null,[t(" Cover monthly costs for server operation and licence fees. Become sponsor on "),e("a",{href:"https://github.com/sponsors/tfabritius"},"Github"),t(". ")])],-1),Pe=A({__name:"search",setup(P){E({title:"Portfolio Report Search"});const c=L(),S=Q(),i=d(""),r=d(""),v=d([]),_=d(!1),y=d(!1),g=d(!1),q=d("");C(),k(),W(()=>c.query.q,()=>{c.query.q&&(C(),k())});async function U(){$(),await k()}function C(){i.value=c.query.q,r.value=c.query.securityType||""}function $(){const s={q:i.value};r.value&&(s.securityType=r.value),S.push({path:c.path,query:s})}async function k(){if(!!i.value){y.value=!0,_.value=!1,g.value=!1;try{const s={};r.value&&(s.securityType=r.value);const n=await ee(`/securities/search/${encodeURIComponent(i.value.trim())}`,{params:s});y.value=!1,v.value=n,_.value=n.length===0}catch(s){y.value=!1,v.value=[],_.value=!1,g.value=!0,q.value=String(s)}}}function j(s){return s.markets.some(n=>n.firstPriceDate&&n.lastPriceDate)}function F(s){var n;return[...new Set([s.symbolXfra,s.symbolXnas,s.symbolXnys,...(n=s.markets)==null?void 0:n.map(b=>b.symbol)])].filter(b=>!!b)}return(s,n)=>{const b=p("InputText"),G=se,H=p("ProgressSpinner"),K=p("Button"),N=p("Message"),T=p("Card"),M=O,X=p("Chip"),Y=Z,D=J("tooltip");return o(),u("div",ne,[e("div",ae,[m(T,null,{title:l(()=>[le]),content:l(()=>[e("form",{onSubmit:z(U,["prevent"])},[e("div",ue,[m(b,{id:"searchTermInput",modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=a=>i.value=a),type:"search",class:"w-full",autofocus:""},null,8,["modelValue"]),ie]),m(G,{modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=a=>r.value=a),class:"w-full mt-4"},null,8,["modelValue"]),m(K,{type:"submit",disabled:!i.value||y.value,class:"w-full flex justify-content-center mt-4"},{default:l(()=>[y.value?(o(),f(H,{key:1,style:{height:"20px"}})):(o(),u("span",ce,"Search"))]),_:1},8,["disabled"]),_.value?(o(),f(N,{key:0,severity:"info"},{default:l(()=>[de]),_:1})):x("",!0),g.value?(o(),f(N,{key:1,severity:"error"},{default:l(()=>[pe,me,t(h(q.value),1)]),_:1})):x("",!0)],40,re)]),_:1}),v.value.length>0?(o(),f(T,{key:0,class:"mt-4"},{title:l(()=>[_e]),content:l(()=>[(o(!0),u(V,null,I(v.value,a=>(o(),u("div",{key:a.uuid,class:"mb-3"},[e("div",fe,[j(a)?R((o(),u("i",he,null,512)),[[D,"Prices available",void 0,{top:!0}]]):x("",!0),R((o(),f(M,{to:"/securities/"+a.uuid},{default:l(()=>[t(h(a.name),1)]),_:2},1032,["to"])),[[D,"Drag and drop me to Portfolio Performance!",void 0,{top:!0}]]),m(X,{class:"mx-1 text-sm bg-teal-500 text-white"},{default:l(()=>[t(h(a.securityType),1)]),_:2},1024),(o(!0),u(V,null,I(a.tags,w=>(o(),f(Y,{key:w,name:w},null,8,["name"]))),128))]),ve,e("b",null,h(a.isin),1),ye,e("b",null,h(a.wkn),1),be,(o(!0),u(V,null,I(F(a),(w,B)=>(o(),u("span",{key:B},[B!=0?(o(),u("span",xe,", ")):x("",!0),e("span",null,[e("b",null,h(w),1)])]))),128))]))),128))]),_:1})):x("",!0),m(T,{class:"mt-4"},{title:l(()=>[we]),content:l(()=>[Se,ge]),_:1})])])}}});export{Pe as default};
