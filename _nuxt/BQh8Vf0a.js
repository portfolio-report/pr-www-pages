import{al as b,am as g,u as k,an as R,ao as x,w as Q,ap as W,n as _}from"./BsvxEGUR.js";function D(e){return b()?(g(e),!0):!1}function p(e){return typeof e=="function"?e():k(e)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const i=new WeakMap;function M(e,s,l={}){const{mode:y="replace",route:a=R(),router:n=x(),transform:q=o=>o}=l;i.has(n)||i.set(n,new Map);const u=i.get(n);let r=a.query[e];D(()=>{r=void 0});let c;const h=W((o,f)=>(c=f,{get(){return o(),q(r!==void 0?r:p(s))},set(t){r!==t&&(r=t===s||t===null?void 0:t,u.set(e,t===s||t===null?void 0:t),f(),_(()=>{if(u.size===0)return;const m=Object.fromEntries(u.entries());u.clear();const{params:d,query:w,hash:S}=a;n[p(y)]({params:d,query:{...w,...m},hash:S})}))}}));return Q(()=>a.query[e],o=>{r!==o&&(r=o,c())},{flush:"sync"}),h}export{M as u};
