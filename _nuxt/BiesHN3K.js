import{h as P,l as g,t as r,m as p,q as h,x as u,r as v,B as te,p as oe,C as ne,D as ae,c as se,j as re,w as le,A as ce,E as ue,s as i,u as f,F as w,G as x,v as c,z as ie,i as j,H as S,I as C,J as V,K as O,y as pe,_ as de,L as fe,M as me}from"./BqEduGTg.js";import{_ as _e}from"./41pVbJ3n.js";import{u as ye}from"./BGDufzsR.js";import{_ as he}from"./DlAUqK2U.js";const ve={class:"p-float-label"},be=u("label",null,"Security Type",-1),ge=P({__name:"SelectSecurityType",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const d=e,m=[{text:"*",value:""},{text:"share",value:"share"},{text:"fund",value:"fund"},{text:"bond",value:"bond"},{text:"index",value:"index"}];function a(s){d("update:modelValue",s)}return(s,b)=>{const _=g("Dropdown");return r(),p("span",ve,[h(_,{class:"w-full","model-value":s.modelValue,options:m,"option-label":"text","option-value":"value","show-clear":!0,"onUpdate:modelValue":a},null,8,["model-value"]),be])}}}),we=Symbol.for("nuxt:client-only"),xe=P({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(t,{slots:e,attrs:d}){const m=v(!1);return te(()=>{m.value=!0}),oe(we,!0),a=>{var y;if(m.value)return(y=e.default)==null?void 0:y.call(e);const s=e.fallback||e.placeholder;if(s)return s();const b=a.fallback||a.placeholder||"",_=a.fallbackTag||a.placeholderTag||"span";return p(_,d,b)}}});function Y(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}const Se=864e5;function U(t){const e=Y(t);return e.setHours(0,0,0,0),e}function A(t){const e=Y(t),d=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return d.setUTCFullYear(e.getFullYear()),+t-+d}function Te(t,e){const d=U(t),m=U(e),a=+d-A(d),s=+m-A(m);return Math.round((a-s)/Se)}const N=t=>(fe("data-v-f6dccffc"),t=t(),me(),t),ke={class:"flex justify-content-center"},De={style:{width:"800px"}},qe={class:"p-float-label mt-2"},Ie=N(()=>u("label",{for:"searchTermInput"},"ISIN/WKN/Symbol/Name",-1)),Ce={key:0,class:"font-bold"},Ve=N(()=>u("br",null,null,-1)),Pe={class:"text-lg font-medium flex align-items-center"},Ne={class:"text-600 separator-container"},Re={key:0},Me={key:1},Be=N(()=>u("ul",null,[u("li",null,[c(" Actively maintain and develop the "),u("a",{href:"https://www.github.com/portfolio-report"},"source code on Github"),c(". ")]),u("li",null,[c(" Become member of the "),u("a",{href:"https://forum.portfolio-performance.info"},"forum"),c(" and help other users. ")]),u("li",null,[c(" Cover monthly costs for server operation and licence fees. Become sponsor on "),u("a",{href:"https://github.com/sponsors/tfabritius"},"Github"),c(". ")])],-1)),$e=P({__name:"search",setup(t){const e=ne(),d=ae(),m=se(()=>{let o="https://www.portfolio-report.net/search";return e.query&&e.query.q&&(o+=`?q=${e.query.q}`,e.query.securityType&&(o+=`&securityType=${e.query.securityType}`)),o});re({title:"Portfolio Report Search",link:[{rel:"canonical",href:m.value}]});const a=v(""),s=v(""),b=v([]),_=v(!1),y=v(!1),D=v(!1),R=v("");M(),q(),le(()=>e.query.q,()=>{e.query.q&&(M(),q())});async function F(){H(),await q()}function M(){a.value=e.query.q,s.value=e.query.securityType||""}function H(){const o={q:a.value};s.value&&(o.securityType=s.value),d.push({path:e.path,query:o})}async function q(){if(a.value){y.value=!0,_.value=!1,D.value=!1;try{const o={};s.value&&(o.securityType=s.value);const n=await ye(`/securities/search/${encodeURIComponent(a.value.trim())}`,{params:o});y.value=!1,b.value=n,_.value=n.length===0,n.length===1&&await ce(`/securities/${n[0].uuid}`)}catch(o){y.value=!1,b.value=[],_.value=!1,D.value=!0,R.value=String(o)}}}function L(o){return o.markets.some(n=>n.firstPriceDate&&n.lastPriceDate)}function z(o){return o.markets.some(n=>n.lastPriceDate&&Te(new Date,new Date(n.lastPriceDate))<30)}function G(o){var n;return[...new Set((n=o.markets)==null?void 0:n.map(T=>T.symbol))].filter(T=>!!T)}return(o,n)=>{const T=g("InputText"),E=ge,K=g("ProgressSpinner"),Q=g("Button"),J=xe,B=g("Message"),I=g("Card"),W=de,X=g("Tag"),Z=_e,$=ue("tooltip");return r(),p("div",ke,[u("div",De,[h(I,null,{title:i(()=>[c(" Security Search ")]),content:i(()=>[u("form",{onSubmit:ie(F,["prevent"])},[h(J,null,{default:i(()=>[u("div",qe,[h(T,{id:"searchTermInput",modelValue:f(a),"onUpdate:modelValue":n[0]||(n[0]=l=>j(a)?a.value=l:null),type:"search",class:"w-full",autofocus:""},null,8,["modelValue"]),Ie]),h(E,{modelValue:f(s),"onUpdate:modelValue":n[1]||(n[1]=l=>j(s)?s.value=l:null),class:"w-full mt-4"},null,8,["modelValue"]),h(Q,{type:"submit",disabled:!f(a)||f(y),class:"w-full flex justify-content-center mt-4"},{default:i(()=>[f(y)?(r(),w(K,{key:1,style:{height:"20px"}})):(r(),p("span",Ce,"Search"))]),_:1},8,["disabled"])]),_:1}),f(_)?(r(),w(B,{key:0,severity:"info"},{default:i(()=>[c(" Sorry, no results were found. ")]),_:1})):x("",!0),f(D)?(r(),w(B,{key:1,severity:"error"},{default:i(()=>[c(" Sorry, there was an error:"),Ve,c(S(f(R)),1)]),_:1})):x("",!0)],32)]),_:1}),f(b).length>0?(r(),w(I,{key:0,class:"mt-4"},{title:i(()=>[c(" Results ")]),content:i(()=>[(r(!0),p(C,null,V(f(b),l=>(r(),p("div",{key:l.uuid,class:"mb-3"},[u("div",Pe,[L(l)?O((r(),p("i",{key:0,class:pe(["i-carbon-chart-line mr-1",[{"text-primary":z(l)}]])},null,2)),[[$,"Prices available",void 0,{top:!0}]]):x("",!0),O((r(),w(W,{to:`/securities/${l.uuid}`},{default:i(()=>[c(S(l.name),1)]),_:2},1032,["to"])),[[$,"Drag and drop me to Portfolio Performance!",void 0,{top:!0}]]),h(X,{class:"mx-1 bg-teal-500"},{default:i(()=>[c(S(l.securityType),1)]),_:2},1024),(r(!0),p(C,null,V(l.tags,k=>(r(),w(Z,{key:k,name:k},null,8,["name"]))),128))]),u("div",Ne,[l.isin?(r(),p("span",Re,S(l.isin),1)):x("",!0),l.wkn?(r(),p("span",Me,S(l.wkn),1)):x("",!0),(r(!0),p(C,null,V(G(l),(k,ee)=>(r(),p("span",{key:ee},S(k),1))),128))])]))),128))]),_:1})):x("",!0),h(I,{class:"mt-4"},{title:i(()=>[c(" Your contribution is needed ðŸ’ª ")]),content:i(()=>[c(" Your help is needed to keep this website up and running. Have you thought about contributing? You could: "),Be]),_:1})])])}}}),Ye=he($e,[["__scopeId","data-v-f6dccffc"]]);export{Ye as default};
