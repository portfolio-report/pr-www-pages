import{_ as oe}from"./SecurityTag.53d4af0f.js";import{_ as le}from"./nuxt-link.d7fc7ec4.js";import{d as X,n as T,o as i,c as u,z as ne,f as e,h as w,L as se,r as _,a as n,w as c,e as l,t,k as Y,D as re,M as G,N as K,j as ie,u as ce,b as a,I as M,J as j,K as F,F as O,G as h,H as ue}from"./entry.e1133cda.js";import{u as H}from"./asyncData.0a4cdd62.js";import{u as I}from"./useApi.09f1ecd9.js";import"./_plugin-vue_export-helper.c27b6911.js";const de=X({__name:"CountryFlag",props:{country:null},setup(P){const p=P,b=T(()=>({AR:"i-flagpack-ar",AT:"i-flagpack-at",AU:"i-flagpack-au",BE:"i-flagpack-be",BR:"i-flagpack-br",CA:"i-flagpack-ca",CH:"i-flagpack-ch",CN:"i-flagpack-cn",DE:"i-flagpack-de",DK:"i-flagpack-dk",ES:"i-flagpack-es",FI:"i-flagpack-fi",FR:"i-flagpack-fr",GB:"i-flagpack-gb-ukm",GR:"i-flagpack-gr",IR:"i-flagpack-ie",IN:"i-flagpack-in",IT:"i-flagpack-it",JP:"i-flagpack-jp",KR:"i-flagpack-kr",LI:"i-flagpack-li",LU:"i-flagpack-lu",NL:"i-flagpack-nl",NO:"i-flagpack-no",NZ:"i-flagpack-nz",PL:"i-flagpack-pl",PT:"i-flagpack-pt",RU:"i-flagpack-ru",SE:"i-flagpack-se",SG:"i-flagpack-sg",TR:"i-flagpack-tr",TW:"i-flagpack-tw",US:"i-flagpack-us",VN:"i-flagpack-vn",ZA:"i-flagpack-za"})[p.country]);return(m,d)=>(i(),u("i",{class:ne(["ii",e(b)])},null,2))}}),pe=X({__name:"PricesTable",props:{prices:null},setup(P){const p=P,b=T(()=>p.prices.map(d=>({dateStr:d.date,date:new Date(d.date),close:d.close}))),m=w({date:{operator:se.AND,constraints:[{value:null,matchMode:"dateIs"}]}});return(d,C)=>{const N=_("Calendar"),S=_("Column"),r=_("DataTable");return i(),u("div",null,[n(r,{filters:e(m),"onUpdate:filters":C[0]||(C[0]=f=>Y(m)?m.value=f:null),value:e(b),class:"p-datatable-sm",paginator:!0,rows:10,"sort-field":"date","sort-order":-1,"rows-per-page-options":[10,30,100,300],"filter-display":"menu"},{default:c(()=>[n(S,{field:"date",header:"Date",sortable:"","data-type":"date"},{body:c(({data:f})=>[l(t(f.dateStr),1)]),filter:c(({filterModel:f})=>[n(N,{modelValue:f.value,"onUpdate:modelValue":A=>f.value=A,"date-format":"yy-mm-dd",placeholder:"yyyy-mm-dd"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(S,{field:"close",header:"Close"},{body:c(({data:f})=>[l(t(f.close.toLocaleString(void 0,{minimumFractionDigits:2})),1)]),_:1})]),_:1},8,["filters","value"])])}}}),me={class:"flex justify-content-center"},fe={style:{width:"800px"}},_e={class:"flex flex-wrap"},ye={class:"flex-grow-1"},ge={class:"text-600"},be=a("span",{class:"mt-2 cursor-move w-20rem p-button p-component"},[a("span",{class:"i-carbon-move i-lg p-button-icon p-button-icon-left"}),a("span",{class:"p-button-label"},"Add to Portfolio Performance")],-1),ke=["src"],he={key:0},ve={key:1},xe={key:2},we={key:3},Ce={key:4},Te={key:5},De={key:6},Pe={key:0},Ue=X({__name:"[uuid]",async setup(P){let p,b;const m=w(""),d=w(null),C=re(),{data:N,error:S}=([p,b]=G(()=>H(`security:${C.params.uuid}`,()=>I(`/securities/uuid/${C.params.uuid}`))),p=await p,b(),p);if(S.value||!N.value)throw K({statusCode:404,message:"This page could not be found",fatal:!0});const r=w(N.value),f=T(()=>{var s,y;return(y=(s=r.value)==null?void 0:s.markets)==null?void 0:y.map(g=>{let x;return g.marketCode==="XETR"?x="XETRA (Frankfurt)":g.marketCode==="XFRA"?x="Frankfurt":g.marketCode==="XNAS"?x="NASDAQ":g.marketCode==="XNYS"&&(x="NYSE"),{...g,name:x}})}),{data:A}=([p,b]=G(()=>H("taxonomies",()=>I("/taxonomies/"))),p=await p,b(),p);if(!A.value)throw K({statusCode:404,message:"This page could not be found",fatal:!0});const J=w(A.value),$=T(()=>r.value.securityTaxonomies.map(s=>({...s,weight:Number(s.weight),taxonomy:J.value.find(y=>y.uuid===s.taxonomyUuid)}))),v=T(()=>$.value.filter(s=>s.rootTaxonomyUuid==="5b0d5647-a4e6-4db8-807b-c3a6d11697a7")),E=w(),Q=s=>{E.value.toggle(s)},D=T(()=>$.value.filter(s=>s.rootTaxonomyUuid==="072bba7b-ed7a-4cb4-aab3-91520d00fb00")),L=w(),W=s=>{L.value.toggle(s)};ie(m,async s=>{d.value=await I(`/securities/uuid/${C.params.uuid}/markets/${s}`,{params:{from:"2000-01-01"}})});async function Z({date:s}){if(await I(`/securities/uuid/${r.value.uuid}/markets/${m.value}/prices/${s}`,{method:"delete"}),d.value){const y=d.value.prices.findIndex(g=>g.date===s);delete d.value.prices[y]}}return ce(()=>{var s;return{title:((s=r.value)==null?void 0:s.name)+" - Portfolio Report",link:[{rel:"canonical",href:"https://www.portfolio-report.net/securities/"+r.value.uuid}]}}),(s,y)=>{const g=_("Tag"),x=oe,q=le,B=de,k=_("Column"),R=_("DataTable"),z=_("OverlayPanel"),V=_("TabPanel"),ee=_("Dropdown"),ae=pe,te=_("TabView"),U=ue("tooltip");return i(),u("div",me,[a("div",fe,[a("div",_e,[a("div",ye,[a("h2",null,[l(t(e(r).name)+" ",1),n(g,{class:"mx-1 bg-teal-500 vertical-align-top"},{default:c(()=>[l(t(e(r).securityType),1)]),_:1}),(i(!0),u(M,null,j(e(r).tags,o=>(i(),O(x,{key:o,class:"vertical-align-top",name:o},null,8,["name"]))),128))]),a("div",ge,[F((i(),u("span",null,[l(t(e(r).isin),1)])),[[U,"ISIN",void 0,{top:!0}]]),l(" Â· "),F((i(),u("span",null,[l(t(e(r).wkn),1)])),[[U,"WKN",void 0,{top:!0}]])]),F((i(),O(q,{to:s.$route.path},{default:c(()=>[be]),_:1},8,["to"])),[[U,{escape:!0,value:"<h4>Drag and drop!</h4> To add this security in Portfolio Performance, drag and drop it to securities list or statement of assets."},void 0,{right:!0}]])]),a("div",null,[e(r).logoUrl?(i(),u("img",{key:0,src:e(r).logoUrl,style:{"max-width":"100px","max-height":"100px","mix-blend-mode":"multiply"}},null,8,ke)):h("",!0)])]),n(te,{class:"mt-2"},{default:c(()=>[n(V,{header:"Overview"},{default:c(()=>[a("ul",null,[(i(!0),u(M,null,j(e(f),o=>(i(),u("li",{key:o.marketCode},[l(" Market: "),a("b",null,t(o.name),1),a("ul",null,[a("li",null,[l(" Currency: "),a("b",null,t(o.currencyCode||"-"),1)]),a("li",null,[l(" Symbol: "),a("b",null,t(o.symbol),1)]),a("li",null,[l(" Prices available: "),a("b",null,t(o.firstPriceDate),1),l(" - "),a("b",null,t(o.lastPriceDate),1)])])]))),128)),e(r).symbolXfra?(i(),u("li",he,[l(" Symbol (Frankfurt): "),a("b",null,t(e(r).symbolXfra),1)])):h("",!0),e(r).symbolXnas?(i(),u("li",ve,[l(" Symbol (NASDAQ): "),a("b",null,t(e(r).symbolXnas),1)])):h("",!0),e(r).symbolXnys?(i(),u("li",xe,[l(" Symbol (New York): "),a("b",null,t(e(r).symbolXnys),1)])):h("",!0),e(v).length===1&&e(v)[0].taxonomy?(i(),u("li",we,[l(" Country: "),n(B,{country:e(v)[0].taxonomy.code||""},null,8,["country"]),a("b",null,t(e(v)[0].taxonomy.name)+" ("+t(e(v)[0].taxonomy.code)+") ",1)])):e(v).length>1?(i(),u("li",Ce,[a("a",{href:"#",onClick:Q},"Countries"),n(z,{ref_key:"countriesOverlay",ref:E,"show-close-icon":!0},{default:c(()=>[n(R,{value:e(v),"sort-field":"weight","sort-order":-1,class:"p-datatable-sm mb-2"},{default:c(()=>[n(k,{field:"weight",header:"Percentage",sortable:!0},{body:c(({data:o})=>[l(t(o.weight)+"%",1)]),_:1}),n(k,{field:"taxonomy.name",header:"Country",sortable:!0},{body:c(({data:o})=>[n(B,{country:o.taxonomy.code},null,8,["country"]),l(" "+t(o.taxonomy.name),1)]),_:1}),n(k,{field:"taxonomy.code",header:"Code",sortable:!0})]),_:1},8,["value"])]),_:1},512)])):h("",!0),e(D).length==1&&e(D)[0].taxonomy?(i(),u("li",Te,[l(" Industry: "),a("b",null,t(e(D)[0].taxonomy.name),1)])):e(D).length>1?(i(),u("li",De,[a("a",{href:"#",onClick:W},"Industries"),n(z,{ref_key:"industriesOverlay",ref:L,"show-close-icon":!0},{default:c(()=>[n(R,{value:e(D),"sort-field":"weight","sort-order":-1,class:"p-datatable-sm"},{default:c(()=>[n(k,{field:"weight",header:"Percentage",sortable:!0},{body:c(({data:o})=>[l(t(o.weight)+"%",1)]),_:1}),n(k,{field:"taxonomy.name",header:"Country",sortable:!0})]),_:1},8,["value"])]),_:1},512)])):h("",!0)])]),_:1}),n(V,{header:"Prices"},{default:c(()=>[n(ee,{id:"market",modelValue:e(m),"onUpdate:modelValue":y[0]||(y[0]=o=>Y(m)?m.value=o:null),options:e(f),"option-label":"name","option-value":"marketCode",placeholder:"Please select market"},{option:c(({option:o})=>[l(t(o.name)+" - "+t(o.marketCode),1)]),_:1},8,["modelValue","options"]),e(d)?(i(),u("div",Pe,[a("ul",null,[a("li",null,[l(" Symbol: "),a("b",null,t(e(d).symbol),1)]),a("li",null,[l(" Currency: "),a("b",null,t(e(d).currencyCode||"-"),1)]),a("li",null,[l(" Prices available: "),a("b",null,t(e(d).firstPriceDate),1),l(" - "),a("b",null,t(e(d).lastPriceDate),1)])]),n(ae,{prices:e(d).prices,onDeletePrice:Z},null,8,["prices"])])):h("",!0)]),_:1}),e(r).events&&e(r).events.length>0?(i(),O(V,{key:0,header:"Events"},{default:c(()=>[n(R,{value:e(r).events},{default:c(()=>[n(k,{field:"date",header:"Date"}),n(k,{field:"type",header:"Type",style:{"text-transform":"capitalize"}}),n(k,{header:"..."},{body:c(({data:o})=>[l(t(o.type==="dividend"?o.amount+" "+o.currencyCode:"")+" "+t(o.type==="split"?o.ratio:""),1)]),_:1})]),_:1},8,["value"])]),_:1})):h("",!0)]),_:1})])])}}});export{Ue as default};
