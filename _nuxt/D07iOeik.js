import{O as d,Q as x,w as O,R as _,n as g}from"./xgaZ6Ri8.js";import{t as k,a as y}from"./CBMwDj5z.js";const a=new WeakMap;function j(o,n,f={}){const{mode:q="replace",route:i=d(),router:s=x(),transform:m=t=>t}=f;a.has(s)||a.set(s,new Map);const u=a.get(s);let e=i.query[o];k(()=>{e=void 0});let c;const l=_((t,p)=>(c=p,{get(){return t(),m(e!==void 0?e:y(n))},set(r){e!==r&&(e=r===n||r===null?void 0:r,u.set(o,r===n||r===null?void 0:r),p(),g(()=>{if(u.size===0)return;const h=Object.fromEntries(u.entries());u.clear();const{params:w,query:R,hash:Q}=i;s[y(q)]({params:w,query:{...R,...h},hash:Q})}))}}));return O(()=>i.query[o],t=>{e!==t&&(e=t,c())},{flush:"sync"}),l}export{j as u};
