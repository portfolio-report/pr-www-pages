import{d as $,r as m,o,c,a as f,b as t,u as W,F as E,G as J,h as d,j as z,w as r,f as i,B as h,H as w,I as O,e,A as Z,k as A,t as y,J as I,K as P,L as U,_ as ee}from"./entry.bbfeadc1.js";import{_ as te}from"./SecurityTag.bfc08e31.js";import{u as oe}from"./useApi.ef33728b.js";import"./_plugin-vue_export-helper.a1a6add7.js";const ne={class:"p-float-label"},se=t("label",{for:"dropdown"},"Security Type",-1),ae=$({__name:"SelectSecurityType",props:{modelValue:null},emits:["update:modelValue"],setup(q,{emit:p}){const g=[{text:"*",value:""},{text:"share",value:"share"},{text:"fund",value:"fund"},{text:"bond",value:"bond"},{text:"index",value:"index"}];function u(l){p("update:modelValue",l)}return(l,v)=>{const _=m("Dropdown");return o(),c("span",ne,[f(_,{id:"dropdown",class:"w-full","model-value":q.modelValue,options:g,"option-label":"text","option-value":"value","show-clear":!0,"onUpdate:modelValue":u},null,8,["model-value"]),se])}}}),le={class:"flex justify-content-center"},re={style:{width:"800px"}},ue=["onSubmit"],ie={class:"p-float-label mt-2"},ce=t("label",{for:"searchTermInput"},"ISIN/WKN/Symbol/Name",-1),pe={key:0,class:"font-bold"},de=t("br",null,null,-1),me={class:"text-lg font-medium flex align-items-center"},fe={key:0,class:"i-carbon-chart-line mr-1"},_e={key:0},he=t("ul",null,[t("li",null,[e(" Actively maintain and develop the "),t("a",{href:"https://www.github.com/portfolio-report"},"source code on Github"),e(". ")]),t("li",null,[e(" Become member of the "),t("a",{href:"https://forum.portfolio-performance.info"},"forum"),e(" and help other users. ")]),t("li",null,[e(" Cover monthly costs for server operation and licence fees. Become sponsor on "),t("a",{href:"https://github.com/sponsors/tfabritius"},"Github"),e(". ")])],-1),we=$({__name:"search",setup(q){W({title:"Portfolio Report Search"});const p=E(),g=J(),u=d(""),l=d(""),v=d([]),_=d(!1),b=d(!1),k=d(!1),C=d("");N(),T(),z(()=>p.query.q,()=>{p.query.q&&(N(),T())});async function j(){F(),await T()}function N(){u.value=p.query.q,l.value=p.query.securityType||""}function F(){const n={q:u.value};l.value&&(n.securityType=l.value),g.push({path:p.path,query:n})}async function T(){if(!!u.value){b.value=!0,_.value=!1,k.value=!1;try{const n={};l.value&&(n.securityType=l.value);const s=await oe(`/securities/search/${encodeURIComponent(u.value.trim())}`,{params:n});b.value=!1,v.value=s,_.value=s.length===0}catch(n){b.value=!1,v.value=[],_.value=!1,k.value=!0,C.value=String(n)}}}function G(n){return n.markets.some(s=>s.firstPriceDate&&s.lastPriceDate)}function H(n){var s;return[...new Set([n.symbolXfra,n.symbolXnas,n.symbolXnys,...(s=n.markets)==null?void 0:s.map(x=>x.symbol)])].filter(x=>!!x)}return(n,s)=>{const x=m("InputText"),K=ae,L=m("ProgressSpinner"),M=m("Button"),B=m("Message"),V=m("Card"),X=ee,Y=m("Chip"),Q=te,D=O("tooltip");return o(),c("div",le,[t("div",re,[f(V,null,{title:r(()=>[e("Security Search")]),content:r(()=>[t("form",{onSubmit:Z(j,["prevent"])},[t("div",ie,[f(x,{id:"searchTermInput",modelValue:i(u),"onUpdate:modelValue":s[0]||(s[0]=a=>A(u)?u.value=a:null),type:"search",class:"w-full",autofocus:""},null,8,["modelValue"]),ce]),f(K,{modelValue:i(l),"onUpdate:modelValue":s[1]||(s[1]=a=>A(l)?l.value=a:null),class:"w-full mt-4"},null,8,["modelValue"]),f(M,{type:"submit",disabled:!i(u)||i(b),class:"w-full flex justify-content-center mt-4"},{default:r(()=>[i(b)?(o(),h(L,{key:1,style:{height:"20px"}})):(o(),c("span",pe,"Search"))]),_:1},8,["disabled"]),i(_)?(o(),h(B,{key:0,severity:"info"},{default:r(()=>[e(" Sorry, no results were found. ")]),_:1})):w("",!0),i(k)?(o(),h(B,{key:1,severity:"error"},{default:r(()=>[e(" Sorry, there was an error:"),de,e(y(i(C)),1)]),_:1})):w("",!0)],40,ue)]),_:1}),i(v).length>0?(o(),h(V,{key:0,class:"mt-4"},{title:r(()=>[e("Results")]),content:r(()=>[(o(!0),c(I,null,P(i(v),a=>(o(),c("div",{key:a.uuid,class:"mb-3"},[t("div",me,[G(a)?U((o(),c("i",fe,null,512)),[[D,"Prices available",void 0,{top:!0}]]):w("",!0),U((o(),h(X,{to:"/securities/"+a.uuid},{default:r(()=>[e(y(a.name),1)]),_:2},1032,["to"])),[[D,"Drag and drop me to Portfolio Performance!",void 0,{top:!0}]]),f(Y,{class:"mx-1 text-sm bg-teal-500 text-white"},{default:r(()=>[e(y(a.securityType),1)]),_:2},1024),(o(!0),c(I,null,P(a.tags,S=>(o(),h(Q,{key:S,name:S},null,8,["name"]))),128))]),e(" ISIN: "),t("b",null,y(a.isin),1),e(" | WKN: "),t("b",null,y(a.wkn),1),e(" | Symbol(s): "),(o(!0),c(I,null,P(H(a),(S,R)=>(o(),c("span",{key:R},[R!=0?(o(),c("span",_e,", ")):w("",!0),t("span",null,[t("b",null,y(S),1)])]))),128))]))),128))]),_:1})):w("",!0),f(V,{class:"mt-4"},{title:r(()=>[e("Your contribution is needed \u{1F4AA}")]),content:r(()=>[e(" Your help is needed to keep this website up and running. Have you thought about contributing? You could: "),he]),_:1})])])}}});export{we as default};
