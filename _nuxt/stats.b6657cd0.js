import{u as A,b as O,_ as P,a as z}from"./useConfirmDialog.eefefac8.js";import{d as N,u as R,i as n,D as j,o as q,c as H,a as o,w as i,r as p,b as a,q as V}from"./entry.513b7bb4.js";import{d as M}from"./debounce.b2fdd475.js";import"./TextBtn.0c174420.js";import"./_plugin-vue_export-helper.a1a6add7.js";const S={class:"p-float-label mt-4"},G=a("label",{for:"timestamp"},"Timestamp",-1),J={class:"p-float-label mt-4"},K=a("label",{for:"version"},"Version",-1),L={class:"p-float-label mt-4"},Q=a("label",{for:"country"},"Country",-1),W={class:"p-float-label mt-4"},X=a("label",{for:"useragent"},"User Agent",-1),Y=a("h5",{class:"m-0"},"Client updates",-1),ne=N({__name:"stats",setup(Z){R({title:"Portfolio Report Admin"});const C=A(),d=n(!1),s=n({id:0,timestamp:"",version:"",country:"",useragent:""}),g=n([]),v=n({version:{value:null,matchMode:""}}),f=n(10),r=n({first:0,sortField:null,sortOrder:null}),h=e=>{r.value.first=e.first,f.value=e.rows,y(e)},y=e=>{(typeof e.sortField=="string"||typeof e.sortField>"u"||e.sortField===null)&&(r.value.sortField=e.sortField),r.value.sortOrder=e.sortOrder,m()},F=()=>{m()},w=n(0),_=n(!1);async function D(){_.value=!0;const e=await V("/stats/",{params:{sort:r.value.sortField,skip:r.value.first,limit:f.value,desc:r.value.sortOrder===-1,version:v.value.version.value}});g.value=e.entries,w.value=e.params.totalCount,_.value=!1}const m=M(D,300);j(()=>{m()});function U(e){s.value=Object.assign({},e),d.value=!0}function k(){d.value=!1}async function x(e){await C({message:`Are you sure you want to delete this entry (${e.timestamp})?`,header:"Delete entry",icon:"i-carbon-warning"})&&(await V(`/stats/${e.id}`,{method:"delete"}),m())}return(e,l)=>{const u=p("InputText"),E=O,$=p("Dialog"),c=p("Column"),B=P,I=z,T=p("DataTable");return q(),H("div",null,[o($,{visible:d.value,"onUpdate:visible":l[4]||(l[4]=t=>d.value=t),header:"Edit Client Update",style:{"max-width":"600"},modal:!0},{footer:i(()=>[o(E,{label:"Cancel",onClick:k})]),default:i(()=>[a("div",S,[o(u,{id:"timestamp",modelValue:s.value.timestamp,"onUpdate:modelValue":l[0]||(l[0]=t=>s.value.timestamp=t),class:"w-20rem"},null,8,["modelValue"]),G]),a("div",J,[o(u,{id:"version",modelValue:s.value.version,"onUpdate:modelValue":l[1]||(l[1]=t=>s.value.version=t),class:"w-10rem"},null,8,["modelValue"]),K]),a("div",L,[o(u,{id:"country",modelValue:s.value.country,"onUpdate:modelValue":l[2]||(l[2]=t=>s.value.country=t),class:"w-10rem"},null,8,["modelValue"]),Q]),a("div",W,[o(u,{id:"useragent",modelValue:s.value.useragent,"onUpdate:modelValue":l[3]||(l[3]=t=>s.value.useragent=t),class:"w-25rem"},null,8,["modelValue"]),X])]),_:1},8,["visible"]),o(T,{filters:v.value,"onUpdate:filters":l[5]||(l[5]=t=>v.value=t),value:g.value,lazy:!0,paginator:!0,loading:_.value,"total-records":w.value,rows:f.value,class:"p-datatable-sm","rows-per-page-options":[10,25,50,100],"sort-field":"timestamp","sort-order":1,"filter-display":"menu",onPage:h,onSort:y,onFilter:F},{header:i(()=>[Y]),default:i(()=>[o(c,{field:"timestamp",header:"Timestamp",sortable:!0}),o(c,{field:"version",header:"Version",sortable:!0,"show-filter-match-modes":!1},{filter:i(({filterModel:t})=>[o(u,{modelValue:t.value,"onUpdate:modelValue":b=>t.value=b,type:"text",class:"p-column-filter",placeholder:"Filter by version"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(c,{field:"country",header:"Country",sortable:!0}),o(c,{header:"Actions"},{body:i(({data:t})=>[o(B,{small:"",onClick:b=>U(t)},null,8,["onClick"]),o(I,{small:"",onClick:b=>x(t)},null,8,["onClick"])]),_:1})]),_:1},8,["filters","value","loading","total-records","rows"])])}}});export{ne as default};
