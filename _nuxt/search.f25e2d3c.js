import{d as A,r as d,o,c as u,a as m,b as t,u as E,D as L,E as Q,h as p,j as W,w as l,F as f,G as x,H as J,e,A as z,t as h,I as V,J as I,K as R,_ as O}from"./entry.6ddbcc5e.js";import{_ as Z}from"./SecurityTag.d1018b9f.js";import{u as ee}from"./useApi.01e786c3.js";import"./_plugin-vue_export-helper.a1a6add7.js";const te={class:"p-float-label"},oe=t("label",{for:"dropdown"},"Security Type",-1),ne=A({__name:"SelectSecurityType",props:{modelValue:null},emits:["update:modelValue"],setup(P,{emit:c}){const S=[{text:"*",value:""},{text:"share",value:"share"},{text:"fund",value:"fund"},{text:"bond",value:"bond"},{text:"index",value:"index"}];function i(r){c("update:modelValue",r)}return(r,v)=>{const _=d("Dropdown");return o(),u("span",te,[m(_,{id:"dropdown",class:"w-full","model-value":P.modelValue,options:S,"option-label":"text","option-value":"value","show-clear":!0,"onUpdate:modelValue":i},null,8,["model-value"]),oe])}}}),se={class:"flex justify-content-center"},ae={style:{width:"800px"}},le=["onSubmit"],re={class:"p-float-label mt-2"},ue=t("label",{for:"searchTermInput"},"ISIN/WKN/Symbol/Name",-1),ie={key:0,class:"font-bold"},ce=t("br",null,null,-1),pe={class:"text-lg font-medium flex align-items-center"},de={key:0,class:"i-carbon-chart-line mr-1"},me={key:0},_e=t("ul",null,[t("li",null,[e(" Actively maintain and develop the "),t("a",{href:"https://www.github.com/portfolio-report"},"source code on Github"),e(". ")]),t("li",null,[e(" Become member of the "),t("a",{href:"https://forum.portfolio-performance.info"},"forum"),e(" and help other users. ")]),t("li",null,[e(" Cover monthly costs for server operation and licence fees. Become sponsor on "),t("a",{href:"https://github.com/sponsors/tfabritius"},"Github"),e(". ")])],-1),be=A({__name:"search",setup(P){E({title:"Portfolio Report Search"});const c=L(),S=Q(),i=p(""),r=p(""),v=p([]),_=p(!1),y=p(!1),g=p(!1),q=p("");C(),k(),W(()=>c.query.q,()=>{c.query.q&&(C(),k())});async function U(){$(),await k()}function C(){i.value=c.query.q,r.value=c.query.securityType||""}function $(){const n={q:i.value};r.value&&(n.securityType=r.value),S.push({path:c.path,query:n})}async function k(){if(!!i.value){y.value=!0,_.value=!1,g.value=!1;try{const n={};r.value&&(n.securityType=r.value);const s=await ee(`/securities/search/${encodeURIComponent(i.value.trim())}`,{params:n});y.value=!1,v.value=s,_.value=s.length===0}catch(n){y.value=!1,v.value=[],_.value=!1,g.value=!0,q.value=String(n)}}}function j(n){return n.markets.some(s=>s.firstPriceDate&&s.lastPriceDate)}function F(n){var s;return[...new Set([n.symbolXfra,n.symbolXnas,n.symbolXnys,...(s=n.markets)==null?void 0:s.map(b=>b.symbol)])].filter(b=>!!b)}return(n,s)=>{const b=d("InputText"),G=ne,H=d("ProgressSpinner"),K=d("Button"),N=d("Message"),T=d("Card"),M=O,X=d("Chip"),Y=Z,D=J("tooltip");return o(),u("div",se,[t("div",ae,[m(T,null,{title:l(()=>[e("Security Search")]),content:l(()=>[t("form",{onSubmit:z(U,["prevent"])},[t("div",re,[m(b,{id:"searchTermInput",modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),type:"search",class:"w-full",autofocus:""},null,8,["modelValue"]),ue]),m(G,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=a=>r.value=a),class:"w-full mt-4"},null,8,["modelValue"]),m(K,{type:"submit",disabled:!i.value||y.value,class:"w-full flex justify-content-center mt-4"},{default:l(()=>[y.value?(o(),f(H,{key:1,style:{height:"20px"}})):(o(),u("span",ie,"Search"))]),_:1},8,["disabled"]),_.value?(o(),f(N,{key:0,severity:"info"},{default:l(()=>[e(" Sorry, no results were found. ")]),_:1})):x("",!0),g.value?(o(),f(N,{key:1,severity:"error"},{default:l(()=>[e(" Sorry, there was an error:"),ce,e(h(q.value),1)]),_:1})):x("",!0)],40,le)]),_:1}),v.value.length>0?(o(),f(T,{key:0,class:"mt-4"},{title:l(()=>[e("Results")]),content:l(()=>[(o(!0),u(V,null,I(v.value,a=>(o(),u("div",{key:a.uuid,class:"mb-3"},[t("div",pe,[j(a)?R((o(),u("i",de,null,512)),[[D,"Prices available",void 0,{top:!0}]]):x("",!0),R((o(),f(M,{to:"/securities/"+a.uuid},{default:l(()=>[e(h(a.name),1)]),_:2},1032,["to"])),[[D,"Drag and drop me to Portfolio Performance!",void 0,{top:!0}]]),m(X,{class:"mx-1 text-sm bg-teal-500 text-white"},{default:l(()=>[e(h(a.securityType),1)]),_:2},1024),(o(!0),u(V,null,I(a.tags,w=>(o(),f(Y,{key:w,name:w},null,8,["name"]))),128))]),e(" ISIN: "),t("b",null,h(a.isin),1),e(" | WKN: "),t("b",null,h(a.wkn),1),e(" | Symbol(s): "),(o(!0),u(V,null,I(F(a),(w,B)=>(o(),u("span",{key:B},[B!=0?(o(),u("span",me,", ")):x("",!0),t("span",null,[t("b",null,h(w),1)])]))),128))]))),128))]),_:1})):x("",!0),m(T,{class:"mt-4"},{title:l(()=>[e("Your contribution is needed \u{1F4AA}")]),content:l(()=>[e(" Your help is needed to keep this website up and running. Have you thought about contributing? You could: "),_e]),_:1})])])}}});export{be as default};
