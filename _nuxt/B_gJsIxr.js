import{h as P,l as q,t,m as p,q as x,x as l,r as S,B as E,p as Z,C as ee,D as te,u as _,E as oe,F as ne,G as se,w as ae,n as re,H as le,c as ue,j as ce,A as ie,I as pe,s as m,J as V,K as w,v as r,z as de,i as U,L as T,M as N,N as $,O as j,_ as fe,P as me,Q as _e}from"./C3Ttcuun.js";import{_ as ye}from"./WTakPW1t.js";import{u as he}from"./DfrbWAww.js";import{_ as ve}from"./DlAUqK2U.js";const be={class:"p-float-label"},ge=l("label",null,"Security Type",-1),xe=P({__name:"SelectSecurityType",props:{modelValue:{}},emits:["update:modelValue"],setup(s,{emit:a}){const v=a,d=[{text:"*",value:""},{text:"share",value:"share"},{text:"fund",value:"fund"},{text:"crypto",value:"crypto"},{text:"bond",value:"bond"},{text:"index",value:"index"}];function f(e){v("update:modelValue",e)}return(e,y)=>{const i=q("Dropdown");return t(),p("span",be,[x(i,{class:"w-full","model-value":e.modelValue,options:d,"option-label":"text","option-value":"value","show-clear":!0,"onUpdate:modelValue":f},null,8,["model-value"]),ge])}}}),Se=Symbol.for("nuxt:client-only"),ke=P({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(s,{slots:a,attrs:v}){const d=S(!1);return E(()=>{d.value=!0}),Z(Se,!0),f=>{var u;if(d.value)return(u=a.default)==null?void 0:u.call(a);const e=a.fallback||a.placeholder;if(e)return e();const y=f.fallback||f.placeholder||"",i=f.fallbackTag||f.placeholderTag||"span";return p(i,v,y)}}});function we(s){return ee()?(te(s),!0):!1}function Q(s){return typeof s=="function"?s():_(s)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const M=new WeakMap;function W(s,a,v={}){const{mode:d="replace",route:f=oe(),router:e=ne(),transform:y=g=>g}=v;M.has(e)||M.set(e,new Map);const i=M.get(e);let u=f.query[s];we(()=>{u=void 0});let b;const I=se((g,C)=>(b=C,{get(){return g(),y(u!==void 0?u:Q(a))},set(h){u!==h&&(u=h===a||h===null?void 0:h,i.set(s,h===a||h===null?void 0:h),C(),re(()=>{if(i.size===0)return;const B=Object.fromEntries(i.entries());i.clear();const{params:o,query:c,hash:k}=f;e[Q(d)]({params:o,query:{...c,...B},hash:k})}))}}));return ae(()=>f.query[s],g=>{u=g,b()},{flush:"sync"}),I}const O=s=>(me("data-v-5cb86587"),s=s(),_e(),s),Te={class:"flex justify-content-center"},qe={style:{width:"800px"}},Ve={class:"p-float-label mt-2"},Ie=O(()=>l("label",{for:"searchTermInput"},"ISIN/WKN/Symbol/Name",-1)),Ce={key:0,class:"font-bold"},Re=O(()=>l("br",null,null,-1)),Be={class:"text-lg font-medium flex align-items-center"},De={key:0,class:"i-carbon-chart-line mr-1 text-primary"},Ne={class:"text-600 separator-container"},$e={key:0},Me={key:1},Pe={key:2},Oe=O(()=>l("ul",null,[l("li",null,[r(" Actively maintain and develop the "),l("a",{href:"https://www.github.com/portfolio-report"},"source code on Github"),r(". ")]),l("li",null,[r(" Become member of the "),l("a",{href:"https://forum.portfolio-performance.info"},"forum"),r(" and help other users. ")]),l("li",null,[r(" Cover monthly costs for server operation and licence fees. Become sponsor on "),l("a",{href:"https://github.com/sponsors/tfabritius"},"Github"),r(". ")])],-1)),Ae=P({__name:"search",setup(s){const a=W("q","",{transform:o=>o||""}),v=W("securityType","",{transform:o=>o||""}),d=le(),f=ue(()=>{let o="https://www.portfolio-report.net/search";return d.query&&d.query.q&&(o+=`?q=${d.query.q}`,d.query.securityType&&(o+=`&securityType=${d.query.securityType}`)),o});ce({title:"Portfolio Report Search",link:[{rel:"canonical",href:f.value}]});const e=S(a.value),y=S(v.value),i=S([]),u=S(!1),b=S(!1),I=S(!1),g=S("");async function C(){e.value=e.value.trim(),a.value=e.value,v.value=y.value,h()}E(()=>{h()});async function h(){if(a.value){b.value=!0,u.value=!1,I.value=!1;try{const o={q:a.value};y.value&&(o.securityType=v.value);const c=await he("/v1/securities/search",{params:o});b.value=!1,i.value=c,u.value=c.length===0,c.length===1&&await ie(`/securities/${c[0].uuid}`)}catch(o){b.value=!1,i.value=[],u.value=!1,I.value=!0,g.value=String(o)}}}function B(o){var c;return[...new Set((c=o.markets)==null?void 0:c.map(k=>k.symbol))].filter(k=>!!k)}return(o,c)=>{const k=q("InputText"),H=xe,L=q("ProgressSpinner"),Y=q("Button"),z=ke,A=q("Message"),D=q("Card"),F=fe,K=q("Tag"),J=ye,G=pe("tooltip");return t(),p("div",Te,[l("div",qe,[x(D,null,{title:m(()=>[r(" Security Search ")]),content:m(()=>[l("form",{onSubmit:de(C,["prevent"])},[x(z,null,{default:m(()=>[l("div",Ve,[x(k,{id:"searchTermInput",modelValue:_(e),"onUpdate:modelValue":c[0]||(c[0]=n=>U(e)?e.value=n:null),type:"search",class:"w-full",autofocus:""},null,8,["modelValue"]),Ie]),x(H,{modelValue:_(y),"onUpdate:modelValue":c[1]||(c[1]=n=>U(y)?y.value=n:null),class:"w-full mt-4"},null,8,["modelValue"]),x(Y,{type:"submit",disabled:!_(e)||_(b),class:"w-full flex justify-content-center mt-4"},{default:m(()=>[_(b)?(t(),V(L,{key:1,style:{height:"20px"}})):(t(),p("span",Ce,"Search"))]),_:1},8,["disabled"])]),_:1}),_(u)?(t(),V(A,{key:0,severity:"info"},{default:m(()=>[r(" Sorry, no results were found. ")]),_:1})):w("",!0),_(I)?(t(),V(A,{key:1,severity:"error"},{default:m(()=>[r(" Sorry, there was an error:"),Re,r(T(_(g)),1)]),_:1})):w("",!0)],32)]),_:1}),_(i).length>0?(t(),V(D,{key:0,class:"mt-4"},{title:m(()=>[r(" Results ")]),content:m(()=>[(t(!0),p(N,null,$(_(i),n=>(t(),p("div",{key:n.uuid,class:"mb-3"},[l("div",Be,[n.pricesAvailable?j((t(),p("i",De,null,512)),[[G,"Prices available",void 0,{top:!0}]]):w("",!0),j((t(),V(F,{to:`/securities/${n.uuid}`},{default:m(()=>[r(T(n.name),1)]),_:2},1032,["to"])),[[G,"Drag and drop me to Portfolio Performance!",void 0,{top:!0}]]),x(K,{class:"mx-1 bg-teal-500"},{default:m(()=>[r(T(n.securityType),1)]),_:2},1024),(t(!0),p(N,null,$(n.tags,R=>(t(),V(J,{key:R,name:R},null,8,["name"]))),128))]),l("div",Ne,[n.isin?(t(),p("span",$e,T(n.isin),1)):w("",!0),n.wkn?(t(),p("span",Me,T(n.wkn),1)):w("",!0),(t(!0),p(N,null,$(B(n),(R,X)=>(t(),p("span",{key:X},T(R),1))),128)),n.code?(t(),p("span",Pe,T(n.code),1)):w("",!0)])]))),128))]),_:1})):w("",!0),x(D,{class:"mt-4"},{title:m(()=>[r(" Your contribution is needed ðŸ’ª ")]),content:m(()=>[r(" Your help is needed to keep this website up and running. Have you thought about contributing? You could: "),Oe]),_:1})])])}}}),We=ve(Ae,[["__scopeId","data-v-5cb86587"]]);export{We as default};
