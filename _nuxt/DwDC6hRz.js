import{t as x,a as p}from"./CoLUwiqn.js";import{ad as Q,ae as _,af as g,w as k,n as M}from"./CRYZwY3H.js";const i=new WeakMap;function j(o,n,y={}){const{mode:q="replace",route:a=Q(),router:s=_(),transform:m=t=>t}=y;i.has(s)||i.set(s,new Map);const u=i.get(s);let e=a.query[o];x(()=>{e=void 0});let c;const l=g((t,f)=>(c=f,{get(){return t(),m(e!==void 0?e:p(n))},set(r){e!==r&&(e=r===n||r===null?void 0:r,u.set(o,r===n||r===null?void 0:r),f(),M(()=>{if(u.size===0)return;const h=Object.fromEntries(u.entries());u.clear();const{params:w,query:d,hash:R}=a;s[p(q)]({params:w,query:{...d,...h},hash:R})}))}}));return k(()=>a.query[o],t=>{e!==t&&(e=t,c())},{flush:"sync"}),l}export{j as u};
