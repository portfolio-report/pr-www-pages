import{u as z,a as H,_ as K}from"./useConfirmDialog.ac96e94c.js";import{d as E,P as I,r as p,o as n,c as d,a as s,w as _,n as g,m as D,k as m,i as C,f as O,g as W,h as G,j as J,B as Z,u as ee,b as e,e as a,t as l,_ as te,R as oe,S as le,F as B,l as V,q as $}from"./entry.ad3e0689.js";import{_ as ae}from"./SecurityTag.2de09520.js";import{u as se}from"./asyncData.5c5313e1.js";import{_ as ne}from"./SecurityDialog.vue_vue_type_script_setup_true_lang.840ac499.js";import"./TextBtn.21f8fae0.js";import"./_plugin-vue_export-helper.a1a6add7.js";import"./AcceptBtn.vue_vue_type_script_setup_true_lang.f67c51af.js";const ie=E({__name:"PricesTable",props:{prices:null},emits:["deletePrice"],setup(N,{emit:h}){const k=I(),y=z();async function u(v){await y({message:`Are you sure you want to delete the price of ${v.date}?`,header:"Delete price",icon:"i-carbon-warning"})&&h("deletePrice",{date:v.date})}return(v,x)=>{const b=p("Column"),P=H,t=p("DataTable");return n(),d("div",null,[s(t,{value:N.prices,class:"p-datatable-sm",paginator:!0,rows:10,"rows-per-page-options":[10,30,100,300]},{default:_(()=>[s(b,{field:"date",header:"Date",sortable:!0}),s(b,{field:"close",header:"Close"}),g(k).loggedIn?(n(),D(b,{key:0,style:{"min-width":"8rem"}},{body:_(w=>[s(P,{onClick:A=>u(w.data)},null,8,["onClick"])]),_:1})):m("",!0)]),_:1},8,["value"])])}}}),ue={class:"flex justify-content-center"},re={style:{width:"800px"}},ce={class:"flex flex-wrap"},de={class:"flex-grow-1"},_e=["src"],me={key:0},pe=a(" UUID: "),ve=a(" ISIN: "),fe=a(" WKN: "),he=a(" Market: "),ye=a(" Currency: "),be=a(" Symbol: "),ge=a(" Prices available: "),ke=a(" - "),we={key:1},Ce=a(" Symbol (Frankfurt): "),De={key:2},xe=a(" Symbol (NASDAQ): "),Pe={key:3},Te=a(" Symbol (New York): "),Se=a(" Type: "),$e={key:4},Ne=a(" Tags: "),Ae={key:0},Xe=a(" Symbol: "),Be=a(" Currency: "),Ve=a(" Prices available: "),Ee=a(" - "),Qe=E({__name:"[uuid]",async setup(N){let h,k;const y=C(""),u=C(null),v=O(),x=I(),{data:b,error:P}=([h,k]=W(()=>se(`security:${v.params.uuid}`,()=>$(`/securities/uuid/${v.params.uuid}`))),h=await h,k(),h);if(P.value||!b.value)throw G({statusCode:404,message:"This page could not be found",fatal:!0});const t=C(b.value),w=C(null);async function A(i){var c;const r=await((c=w.value)==null?void 0:c.show(i));r&&(t.value={...t.value,...r})}const X=J(()=>{var i,r;return(r=(i=t.value)==null?void 0:i.markets)==null?void 0:r.map(c=>{let f;return c.marketCode==="XETR"?f="XETRA (Frankfurt)":c.marketCode==="XFRA"?f="Frankfurt":c.marketCode==="XNAS"?f="NASDAQ":c.marketCode==="XNYS"&&(f="NYSE"),{...c,name:f}})});Z(y,async i=>{u.value=await $(`/securities/uuid/${v.params.uuid}/markets/${i}`,{params:{from:"2000-01-01"}})});async function F({date:i}){if(await $(`/securities/uuid/${t.value.uuid}/markets/${y.value}/prices/${i}`,{method:"delete"}),u.value){const r=u.value.prices.findIndex(c=>c.date===i);delete u.value.prices[r]}}return ee(()=>{var i;return{title:((i=t.value)==null?void 0:i.name)+" - Portfolio Report"}}),(i,r)=>{const c=K,f=p("Button"),R=te,U=p("Chip"),M=ae,T=p("TabPanel"),Y=p("Dropdown"),j=ie,S=p("Column"),L=p("DataTable"),Q=p("TabView"),q=oe("tooltip");return n(),d("div",ue,[e("div",re,[e("div",ce,[e("div",de,[e("h2",null,[a(l(t.value.name)+" ",1),g(x).loggedIn?(n(),D(c,{key:0,onClick:r[0]||(r[0]=o=>A(t.value))})):m("",!0)]),s(R,{to:i.$route.path},{default:_(()=>[le(s(f,{class:"mt-2 cursor-move w-20rem",icon:"i-carbon-move i-lg",label:"Add to Portfolio Performance"},null,512),[[q,{escape:!0,value:"<h4>Drag and drop!</h4> To add this security in Portfolio Performance, drag and drop it to securities list or statement of assets."},void 0,{right:!0}]])]),_:1},8,["to"])]),t.value.logoUrl?(n(),d("img",{key:0,src:t.value.logoUrl,style:{"max-width":"100px","max-height":"100px","mix-blend-mode":"multiply"}},null,8,_e)):m("",!0)]),s(Q,{class:"mt-2"},{default:_(()=>[s(T,{header:"Overview"},{default:_(()=>[e("ul",null,[g(x).loggedIn?(n(),d("li",me,[pe,e("b",null,l(t.value.uuid),1)])):m("",!0),e("li",null,[ve,e("b",null,l(t.value.isin),1)]),e("li",null,[fe,e("b",null,l(t.value.wkn),1)]),(n(!0),d(B,null,V(g(X),o=>(n(),d("li",{key:o.marketCode},[he,e("b",null,l(o.name),1),e("ul",null,[e("li",null,[ye,e("b",null,l(o.currencyCode||"-"),1)]),e("li",null,[be,e("b",null,l(o.symbol),1)]),e("li",null,[ge,e("b",null,l(o.firstPriceDate),1),ke,e("b",null,l(o.lastPriceDate),1)])])]))),128)),t.value.symbolXfra?(n(),d("li",we,[Ce,e("b",null,l(t.value.symbolXfra),1)])):m("",!0),t.value.symbolXnas?(n(),d("li",De,[xe,e("b",null,l(t.value.symbolXnas),1)])):m("",!0),t.value.symbolXnys?(n(),d("li",Pe,[Te,e("b",null,l(t.value.symbolXnys),1)])):m("",!0),e("li",null,[Se,s(U,{class:"mx-1 text-sm bg-teal-500 text-white"},{default:_(()=>[a(l(t.value.securityType),1)]),_:1})]),t.value.tags&&t.value.tags.length>0?(n(),d("li",$e,[Ne,(n(!0),d(B,null,V(t.value.tags,o=>(n(),D(M,{key:o,name:o},null,8,["name"]))),128))])):m("",!0)])]),_:1}),s(T,{header:"Prices"},{default:_(()=>[s(Y,{id:"market",modelValue:y.value,"onUpdate:modelValue":r[1]||(r[1]=o=>y.value=o),options:g(X),"option-label":"name","option-value":"marketCode",placeholder:"Please select market"},{option:_(({option:o})=>[a(l(o.name)+" - "+l(o.marketCode),1)]),_:1},8,["modelValue","options"]),u.value?(n(),d("div",Ae,[e("ul",null,[e("li",null,[Xe,e("b",null,l(u.value.symbol),1)]),e("li",null,[Be,e("b",null,l(u.value.currencyCode||"-"),1)]),e("li",null,[Ve,e("b",null,l(u.value.firstPriceDate),1),Ee,e("b",null,l(u.value.lastPriceDate),1)])]),s(j,{prices:u.value.prices,onDeletePrice:F},null,8,["prices"])])):m("",!0)]),_:1}),t.value.events&&t.value.events.length>0?(n(),D(T,{key:0,header:"Events"},{default:_(()=>[s(L,{value:t.value.events},{default:_(()=>[s(S,{field:"date",header:"Date"}),s(S,{field:"type",header:"Type",style:{"text-transform":"capitalize"}}),s(S,{header:"..."},{body:_(({data:o})=>[a(l(o.type==="dividend"?o.amount+" "+o.currencyCode:"")+" "+l(o.type==="split"?o.ratio:""),1)]),_:1})]),_:1},8,["value"])]),_:1})):m("",!0)]),_:1})]),s(ne,{ref_key:"securityDialog",ref:w},null,512)])}}});export{Qe as default};
