import{d as N,r as b,o as l,c as m,a as h,b as u,h as v,F as te,G as ne,H as oe,n as ae,u as re,j as se,w as f,f as p,B as w,I as D,J as le,e as r,A as ue,k as U,t as S,K as P,L as V,M as L,z as ie,_ as ce}from"./entry.d58d3095.js";import{_ as fe}from"./SecurityTag.b875533a.js";import{u as pe}from"./useApi.ce1daea2.js";import"./_plugin-vue_export-helper.c27b6911.js";const me={class:"p-float-label"},de=u("label",{for:"dropdown"},"Security Type",-1),ye=N({__name:"SelectSecurityType",props:{modelValue:null},emits:["update:modelValue"],setup(t,{emit:e}){const s=[{text:"*",value:""},{text:"share",value:"share"},{text:"fund",value:"fund"},{text:"bond",value:"bond"},{text:"index",value:"index"}];function d(o){e("update:modelValue",o)}return(o,i)=>{const y=b("Dropdown");return l(),m("span",me,[h(y,{id:"dropdown",class:"w-full","model-value":t.modelValue,options:s,"option-label":"text","option-value":"value","show-clear":!0,"onUpdate:modelValue":d},null,8,["model-value"]),de])}}}),_e=N({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(t,{slots:e,attrs:s}){const d=v(!1);return te(()=>{d.value=!0}),o=>{var _;if(d.value)return(_=e.default)==null?void 0:_.call(e);const i=e.fallback||e.placeholder;if(i)return i();const y=o.fallback||o.placeholder||"",g=o.fallbackTag||o.placeholderTag||"span";return m(g,s,y)}}});function M(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function k(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?k=function(s){return typeof s}:k=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},k(t)}function he(t){M(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||k(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Y(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function j(t){M(1,arguments);var e=he(t);return e.setHours(0,0,0,0),e}var ve=864e5;function be(t,e){M(2,arguments);var s=j(t),d=j(e),o=s.getTime()-Y(s),i=d.getTime()-Y(d);return Math.round((o-i)/ve)}const ge={class:"flex justify-content-center"},we={style:{width:"800px"}},Se=["onSubmit"],Te={class:"p-float-label mt-2"},xe=u("label",{for:"searchTermInput"},"ISIN/WKN/Symbol/Name",-1),De={key:0,class:"font-bold"},ke=u("br",null,null,-1),qe={class:"text-lg font-medium flex align-items-center"},Ce={class:"text-600"},Ie=u("ul",null,[u("li",null,[r(" Actively maintain and develop the "),u("a",{href:"https://www.github.com/portfolio-report"},"source code on Github"),r(". ")]),u("li",null,[r(" Become member of the "),u("a",{href:"https://forum.portfolio-performance.info"},"forum"),r(" and help other users. ")]),u("li",null,[r(" Cover monthly costs for server operation and licence fees. Become sponsor on "),u("a",{href:"https://github.com/sponsors/tfabritius"},"Github"),r(". ")])],-1),Re=N({__name:"search",setup(t){const e=ne(),s=oe(),d=ae(()=>{let n="https://www.portfolio-report.net/search";return e.query&&e.query.q&&(n+="?q="+e.query.q,e.query.securityType&&(n+="&securityType="+e.query.securityType)),n});re({title:"Portfolio Report Search",link:[{rel:"canonical",href:d.value}]});const o=v(""),i=v(""),y=v([]),g=v(!1),_=v(!1),q=v(!1),R=v("");B(),C(),se(()=>e.query.q,()=>{e.query.q&&(B(),C())});async function F(){H(),await C()}function B(){o.value=e.query.q,i.value=e.query.securityType||""}function H(){const n={q:o.value};i.value&&(n.securityType=i.value),s.push({path:e.path,query:n})}async function C(){if(o.value){_.value=!0,g.value=!1,q.value=!1;try{const n={};i.value&&(n.securityType=i.value);const a=await pe(`/securities/search/${encodeURIComponent(o.value.trim())}`,{params:n});_.value=!1,y.value=a,g.value=a.length===0}catch(n){_.value=!1,y.value=[],g.value=!1,q.value=!0,R.value=String(n)}}}function $(n){return n.markets.some(a=>a.firstPriceDate&&a.lastPriceDate)}function E(n){return n.markets.some(a=>a.lastPriceDate&&be(new Date,new Date(a.lastPriceDate))<30)}function G(n){var a;return[...new Set([n.symbolXfra,n.symbolXnas,n.symbolXnys,...(a=n.markets)==null?void 0:a.map(T=>T.symbol)])].filter(T=>!!T)}return(n,a)=>{const T=b("InputText"),z=ye,X=b("ProgressSpinner"),K=b("Button"),Q=_e,O=b("Message"),I=b("Card"),J=ce,W=b("Tag"),Z=fe,A=le("tooltip");return l(),m("div",ge,[u("div",we,[h(I,null,{title:f(()=>[r("Security Search")]),content:f(()=>[u("form",{onSubmit:ue(F,["prevent"])},[h(Q,null,{default:f(()=>[u("div",Te,[h(T,{id:"searchTermInput",modelValue:p(o),"onUpdate:modelValue":a[0]||(a[0]=c=>U(o)?o.value=c:null),type:"search",class:"w-full",autofocus:""},null,8,["modelValue"]),xe]),h(z,{modelValue:p(i),"onUpdate:modelValue":a[1]||(a[1]=c=>U(i)?i.value=c:null),class:"w-full mt-4"},null,8,["modelValue"]),h(K,{type:"submit",disabled:!p(o)||p(_),class:"w-full flex justify-content-center mt-4"},{default:f(()=>[p(_)?(l(),w(X,{key:1,style:{height:"20px"}})):(l(),m("span",De,"Search"))]),_:1},8,["disabled"])]),_:1}),p(g)?(l(),w(O,{key:0,severity:"info"},{default:f(()=>[r(" Sorry, no results were found. ")]),_:1})):D("",!0),p(q)?(l(),w(O,{key:1,severity:"error"},{default:f(()=>[r(" Sorry, there was an error:"),ke,r(S(p(R)),1)]),_:1})):D("",!0)],40,Se)]),_:1}),p(y).length>0?(l(),w(I,{key:0,class:"mt-4"},{title:f(()=>[r("Results")]),content:f(()=>[(l(!0),m(P,null,V(p(y),c=>(l(),m("div",{key:c.uuid,class:"mb-3"},[u("div",qe,[$(c)?L((l(),m("i",{key:0,class:ie(["i-carbon-chart-line","mr-1",{"text-primary":E(c)}])},null,2)),[[A,"Prices available",void 0,{top:!0}]]):D("",!0),L((l(),w(J,{to:"/securities/"+c.uuid},{default:f(()=>[r(S(c.name),1)]),_:2},1032,["to"])),[[A,"Drag and drop me to Portfolio Performance!",void 0,{top:!0}]]),h(W,{class:"mx-1 bg-teal-500"},{default:f(()=>[r(S(c.securityType),1)]),_:2},1024),(l(!0),m(P,null,V(c.tags,x=>(l(),w(Z,{key:x,name:x},null,8,["name"]))),128))]),u("div",Ce,[r(S(c.isin)+" Â· "+S(c.wkn)+" ",1),(l(!0),m(P,null,V(G(c),(x,ee)=>(l(),m("span",{key:ee}," Â· "+S(x),1))),128))])]))),128))]),_:1})):D("",!0),h(I,{class:"mt-4"},{title:f(()=>[r("Your contribution is needed ðŸ’ª")]),content:f(()=>[r(" Your help is needed to keep this website up and running. Have you thought about contributing? You could: "),Ie]),_:1})])])}}});export{Re as default};
