import X from"./CeELpF6D.js";import Z from"./DcxdUbQN.js";import{h as M,t,l as p,m as g,x as l,r as k,B as W,p as ee,C as te,D as oe,u as _,E as ne,F as re,G as se,w as ae,n as le,H as ue,c as ce,j as ie,A as pe,I as de,q as f,J as q,K as w,s as me,v as a,z as fe,i as G,L as T,M as N,N as B,O as U,_ as _e,P as ye,Q as he}from"./wT7o8xK3.js";import ve from"./DZ2-31wD.js";import be from"./Bom0jtNK.js";import xe from"./BQs3D94b.js";import ge from"./DqoPgIh8.js";import{_ as ke}from"./faGvnSrP.js";import{u as Se}from"./jquUBGUu.js";import{_ as we}from"./DlAUqK2U.js";import"./HguarGB3.js";import"./BpJyQZUT.js";import"./Ca5F7eDn.js";import"./D-O2vnUP.js";import"./qF1fJoCB.js";import"./C4pl9d79.js";const Te={class:"p-float-label"},qe=l("label",null,"Security Type",-1),Ve=M({__name:"SelectSecurityType",props:{modelValue:{}},emits:["update:modelValue"],setup(r,{emit:s}){const v=s,d=[{text:"*",value:""},{text:"share",value:"share"},{text:"fund",value:"fund"},{text:"crypto",value:"crypto"},{text:"bond",value:"bond"},{text:"index",value:"index"}];function m(e){v("update:modelValue",e)}return(e,y)=>{const i=Z;return t(),p("span",Te,[g(i,{class:"w-full","model-value":e.modelValue,options:d,"option-label":"text","option-value":"value","show-clear":!0,"onUpdate:modelValue":m},null,8,["model-value"]),qe])}}}),$e=Symbol.for("nuxt:client-only"),Ie=M({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(r,{slots:s,attrs:v}){const d=k(!1);return W(()=>{d.value=!0}),ee($e,!0),m=>{var u;if(d.value)return(u=s.default)==null?void 0:u.call(s);const e=s.fallback||s.placeholder;if(e)return e();const y=m.fallback||m.placeholder||"",i=m.fallbackTag||m.placeholderTag||"span";return p(i,v,y)}}});function Re(r){return te()?(oe(r),!0):!1}function j(r){return typeof r=="function"?r():_(r)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const D=new WeakMap;function Q(r,s,v={}){const{mode:d="replace",route:m=ne(),router:e=re(),transform:y=x=>x}=v;D.has(e)||D.set(e,new Map);const i=D.get(e);let u=m.query[r];Re(()=>{u=void 0});let b;const V=se((x,$)=>(b=$,{get(){return x(),y(u!==void 0?u:j(s))},set(h){u!==h&&(u=h===s||h===null?void 0:h,i.set(r,h===s||h===null?void 0:h),$(),le(()=>{if(i.size===0)return;const R=Object.fromEntries(i.entries());i.clear();const{params:o,query:c,hash:S}=m;e[j(d)]({params:o,query:{...c,...R},hash:S})}))}}));return ae(()=>m.query[r],x=>{u=x,b()},{flush:"sync"}),V}const O=r=>(ye("data-v-d95303d9"),r=r(),he(),r),Ce={class:"flex justify-content-center"},Ne={style:{width:"800px"}},Be={class:"p-float-label mt-2"},De=O(()=>l("label",{for:"searchTermInput"},"ISIN/WKN/Symbol/Name",-1)),Me={key:0,class:"font-bold"},Oe=O(()=>l("br",null,null,-1)),Pe={class:"text-lg font-medium flex align-items-center"},Ae={key:0,class:"i-carbon-chart-line mr-1 text-primary"},Ge={class:"text-600 separator-container font-mono"},Ue={key:0},je={key:1},Qe={key:2},We=O(()=>l("ul",null,[l("li",null,[a(" Actively maintain and develop the "),l("a",{href:"https://www.github.com/portfolio-report"},"source code on Github"),a(". ")]),l("li",null,[a(" Become member of the "),l("a",{href:"https://forum.portfolio-performance.info"},"forum"),a(" and help other users. ")]),l("li",null,[a(" Cover monthly costs for server operation and licence fees. Become sponsor on "),l("a",{href:"https://github.com/sponsors/tfabritius"},"Github"),a(". ")])],-1)),Ee=M({__name:"search",setup(r){const s=Q("q","",{transform:o=>o||""}),v=Q("securityType","",{transform:o=>o||""}),d=ue(),m=ce(()=>{let o="https://www.portfolio-report.net/search";return d.query&&d.query.q&&(o+=`?q=${d.query.q}`,d.query.securityType&&(o+=`&securityType=${d.query.securityType}`)),o});ie({title:"Portfolio Report Search",link:[{rel:"canonical",href:m.value}]});const e=k(s.value),y=k(v.value),i=k([]),u=k(!1),b=k(!1),V=k(!1),x=k("");async function $(){e.value=e.value.trim(),s.value=e.value,v.value=y.value,h()}W(()=>{h()});async function h(){if(s.value){b.value=!0,u.value=!1,V.value=!1;try{const o={q:s.value};y.value&&(o.securityType=v.value);const c=await Se("/v1/securities/search",{params:o});b.value=!1,i.value=c,u.value=c.length===0,c.length===1&&await pe(`/securities/${c[0].uuid}`)}catch(o){b.value=!1,i.value=[],u.value=!1,V.value=!0,x.value=String(o)}}}function R(o){var c;return[...new Set((c=o.markets)==null?void 0:c.map(S=>S.symbol))].filter(S=>!!S)}return(o,c)=>{const S=X,E=Ve,H=ve,L=be,Y=Ie,P=xe,C=me,z=_e,F=ge,K=ke,A=de("tooltip");return t(),p("div",Ce,[l("div",Ne,[g(C,null,{title:f(()=>[a(" Security Search ")]),content:f(()=>[l("form",{onSubmit:fe($,["prevent"])},[g(Y,null,{default:f(()=>[l("div",Be,[g(S,{id:"searchTermInput",modelValue:_(e),"onUpdate:modelValue":c[0]||(c[0]=n=>G(e)?e.value=n:null),type:"search",class:"w-full",autofocus:""},null,8,["modelValue"]),De]),g(E,{modelValue:_(y),"onUpdate:modelValue":c[1]||(c[1]=n=>G(y)?y.value=n:null),class:"w-full mt-4"},null,8,["modelValue"]),g(L,{type:"submit",disabled:!_(e)||_(b),class:"w-full flex justify-content-center mt-4"},{default:f(()=>[_(b)?(t(),q(H,{key:1,style:{height:"20px"}})):(t(),p("span",Me,"Search"))]),_:1},8,["disabled"])]),_:1}),_(u)?(t(),q(P,{key:0,severity:"info"},{default:f(()=>[a(" Sorry, no results were found. ")]),_:1})):w("",!0),_(V)?(t(),q(P,{key:1,severity:"error"},{default:f(()=>[a(" Sorry, there was an error:"),Oe,a(T(_(x)),1)]),_:1})):w("",!0)],32)]),_:1}),_(i).length>0?(t(),q(C,{key:0,class:"mt-4"},{title:f(()=>[a(" Results ")]),content:f(()=>[(t(!0),p(N,null,B(_(i),n=>(t(),p("div",{key:n.uuid,class:"mb-3"},[l("div",Pe,[n.pricesAvailable?U((t(),p("i",Ae,null,512)),[[A,"Prices available",void 0,{top:!0}]]):w("",!0),U((t(),q(z,{to:`/securities/${n.uuid}`},{default:f(()=>[a(T(n.name),1)]),_:2},1032,["to"])),[[A,"Drag and drop me to Portfolio Performance!",void 0,{top:!0}]]),g(F,{class:"mx-1 bg-teal-500"},{default:f(()=>[a(T(n.securityType),1)]),_:2},1024),(t(!0),p(N,null,B(n.tags,I=>(t(),q(K,{key:I,name:I},null,8,["name"]))),128))]),l("div",Ge,[n.isin?(t(),p("span",Ue,T(n.isin),1)):w("",!0),n.wkn?(t(),p("span",je,T(n.wkn),1)):w("",!0),(t(!0),p(N,null,B(R(n),(I,J)=>(t(),p("span",{key:J},T(I),1))),128)),n.code?(t(),p("span",Qe,T(n.code),1)):w("",!0)])]))),128))]),_:1})):w("",!0),g(C,{class:"mt-4"},{title:f(()=>[a(" Your contribution is needed ðŸ’ª ")]),content:f(()=>[a(" Your help is needed to keep this website up and running. Have you thought about contributing? You could: "),We]),_:1})])])}}}),lt=we(Ee,[["__scopeId","data-v-d95303d9"]]);export{lt as default};
