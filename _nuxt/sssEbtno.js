import N from"./CZhFSx6c.js";import O from"./B5swX5Og.js";import W from"./B6jGzkBm.js";import F from"./jKrgviQG.js";import{_ as L}from"./DjajGpnH.js";import S from"./Bor6U50d.js";import z from"./JLHcNFJA.js";import{a as I}from"./DTIfUcLX.js";import{u as R}from"./D4Fiw7j-.js";import{h as Y,r as d,w as q,c as E,l,x as m,m as t,u as a,v as f,G as k,q as y,H as c,I as h,t as i,A as G,i as H,B as P}from"./BeTAzwAv.js";import{s as j}from"./CqX3Gj29.js";import{a as J}from"./3BFghbVf.js";import"./C3mLP0lt.js";import"./D9c5O5eY.js";import"./BtOYg4C_.js";import"./BMhGZG8K.js";import"./B7-i7-Ch.js";import"./DKoil16r.js";import"./lAQCNr8J.js";import"./DlAUqK2U.js";import"./BXksNWDu.js";import"./f4fcV7kE.js";import"./CffZ1U4I.js";import"./CotlX5ub.js";import"./D3b-rPgq.js";import"./Dw3iRmf_.js";import"./NI3ATyxi.js";import"./DI2xaR4V.js";import"./DTQnk4CU.js";import"./Dr3deYh8.js";import"./D0rmquXk.js";import"./CuLwHhsd.js";import"./DGJxJ-Iu.js";import"./CSLGR3Mf.js";import"./BYtPwx8j.js";import"./DUcOCb5I.js";import"./BlX3XweD.js";import"./BRzx1G--.js";const K={class:"p-buttonset"},M={class:"flex items-end",style:{height:"400px"}},Le=Y({__name:"weekly",setup(Q){const n=d(new Date().getFullYear()),w=d();function b(o){w.value.toggle(o)}const _=d(new Date),$=J(_),{data:p,pending:x,refresh:g}=I(`statsWeeks:${n.value}`,async()=>{const o=await R(`/stats/updates/weeks?year=${n.value}`);for(const e of o)e.firstUpdate&&(e.firstUpdate=new Date(e.firstUpdate)),e.lastUpdate&&(e.lastUpdate=new Date(e.lastUpdate));return _.value=new Date,{weeks:o.sort((e,r)=>e.week-r.week)}});q(n,()=>g());const D=E(()=>{var o,e;return{labels:(o=p.value)==null?void 0:o.weeks.map(r=>r.week),datasets:[{backgroundColor:"#3B82F6",data:(e=p.value)==null?void 0:e.weeks.map(r=>r.count)}]}}),B={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}}};return(o,e)=>{const r=N,C=O,U=W,u=F,A=L,v=S,T=z;return i(),l("div",null,[m("div",K,[t(r,{label:"Versions",icon:"i-carbon-tag",class:"p-button-secondary",onClick:e[0]||(e[0]=s=>("navigateTo"in o?o.navigateTo:a(G))("/stats/"))}),t(r,{label:"Weekly",icon:"i-carbon-calendar",class:"p-button-primary",disabled:!0})]),m("h2",null,[f(" Weekly Statistics for "),m("a",{class:"cursor-pointer text-blue-500",onClick:b},k(a(n)),1)]),t(U,{ref_key:"yearOverlay",ref:w,"show-close-icon":!0},{default:y(()=>[t(C,{modelValue:a(n),"onUpdate:modelValue":e[1]||(e[1]=s=>H(n)?n.value=s:null),"use-grouping":!1},null,8,["modelValue"])]),_:1},512),a(x)||!a(p)?(i(),l(c,{key:0},[t(u,{width:"15em"}),m("div",M,[(i(),l(c,null,h([30,25,45,70,90],(s,V)=>t(u,{key:V,width:"20%",height:`${s}%`,class:"mr-2"},null,8,["height"])),64))]),(i(!0),l(c,null,h(Array(10).keys(),s=>(i(),P(u,{key:s,class:"mt-4"}))),128))],64)):(i(),l(c,{key:1},[f(" Last updated "+k(a($))+" ",1),t(A,{small:"",icon:"i-carbon-renew",onClick:e[2]||(e[2]=s=>a(g)())}),t(a(j),{type:"line",data:a(D),options:B,style:{height:"400px"}},null,8,["data"]),t(T,{value:a(p).weeks,"sort-field":"week",class:"font-mono",size:"small","sort-order":-1},{default:y(()=>[t(v,{field:"week",header:"Week",sortable:!0},{body:y(s=>[f(k(s.data.week),1)]),_:1}),t(v,{field:"count",header:"Count",sortable:!0,class:"!text-right"})]),_:1},8,["value"])],64))])}}});export{Le as default};
