import{d as F,n as T,o as u,c as d,z as le,f as e,h as C,M as oe,N as ne,r as _,a as o,w as i,e as n,t,k as G,F as se,O as $,P as L,j as re,u as ie,b as a,H as b,_ as ue,I as ce,L as de,J as M,K as z,B as K}from"./entry.a59404a2.js";import{_ as me}from"./SecurityTag.2b20741c.js";import{u as j}from"./asyncData.90d69d5a.js";import{u as I}from"./useApi.0dee83f7.js";import"./_plugin-vue_export-helper.a1a6add7.js";const pe=F({__name:"CountryFlag",props:{country:null},setup(D){const m=D,k=T(()=>({AR:"i-flagpack-ar",AT:"i-flagpack-at",AU:"i-flagpack-au",BE:"i-flagpack-be",BR:"i-flagpack-br",CA:"i-flagpack-ca",CH:"i-flagpack-ch",CN:"i-flagpack-cn",DE:"i-flagpack-de",DK:"i-flagpack-dk",ES:"i-flagpack-es",FI:"i-flagpack-fi",FR:"i-flagpack-fr",GB:"i-flagpack-gb-ukm",GR:"i-flagpack-gr",IR:"i-flagpack-ie",IN:"i-flagpack-in",IT:"i-flagpack-it",JP:"i-flagpack-jp",KR:"i-flagpack-kr",LI:"i-flagpack-li",LU:"i-flagpack-lu",NL:"i-flagpack-nl",NO:"i-flagpack-no",NZ:"i-flagpack-nz",PL:"i-flagpack-pl",PT:"i-flagpack-pt",RU:"i-flagpack-ru",SE:"i-flagpack-se",SG:"i-flagpack-sg",TR:"i-flagpack-tr",TW:"i-flagpack-tw",US:"i-flagpack-us",VN:"i-flagpack-vn",ZA:"i-flagpack-za"})[m.country]);return(p,c)=>(u(),d("i",{class:le(["ii",e(k)])},null,2))}}),fe=F({__name:"PricesTable",props:{prices:null},setup(D){const m=D,k=T(()=>m.prices.map(c=>({dateStr:c.date,date:new Date(c.date),close:c.close}))),p=C({date:{operator:oe.AND,constraints:[{value:null,matchMode:ne.DATE_IS}]}});return(c,w)=>{const N=_("Calendar"),S=_("Column"),s=_("DataTable");return u(),d("div",null,[o(s,{filters:e(p),"onUpdate:filters":w[0]||(w[0]=f=>G(p)?p.value=f:null),value:e(k),class:"p-datatable-sm",paginator:!0,rows:10,"sort-field":"date","sort-order":-1,"rows-per-page-options":[10,30,100,300],"filter-display":"menu"},{default:i(()=>[o(S,{field:"date",header:"Date",sortable:"","data-type":"date"},{body:i(({data:f})=>[n(t(f.dateStr),1)]),filter:i(({filterModel:f})=>[o(N,{modelValue:f.value,"onUpdate:modelValue":A=>f.value=A,"date-format":"yy-mm-dd",placeholder:"yyyy-mm-dd"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(S,{field:"close",header:"Close"},{body:i(({data:f})=>[n(t(f.close.toLocaleString(void 0,{minimumFractionDigits:2})),1)]),_:1})]),_:1},8,["filters","value"])])}}}),_e={class:"flex justify-content-center"},ye={style:{width:"800px"}},ge={class:"flex flex-wrap"},be={class:"flex-grow-1"},ke=["src"],he={key:0},ve={key:1},xe={key:2},Ce={key:3},we={key:4},Te={key:5},Pe={key:6},De={key:7},Ne={key:0},Fe=F({__name:"[uuid]",async setup(D){let m,k;const p=C(""),c=C(null),w=se(),{data:N,error:S}=([m,k]=$(()=>j(`security:${w.params.uuid}`,()=>I(`/securities/uuid/${w.params.uuid}`))),m=await m,k(),m);if(S.value||!N.value)throw L({statusCode:404,message:"This page could not be found",fatal:!0});const s=C(N.value),f=T(()=>{var r,y;return(y=(r=s.value)==null?void 0:r.markets)==null?void 0:y.map(g=>{let x;return g.marketCode==="XETR"?x="XETRA (Frankfurt)":g.marketCode==="XFRA"?x="Frankfurt":g.marketCode==="XNAS"?x="NASDAQ":g.marketCode==="XNYS"&&(x="NYSE"),{...g,name:x}})}),{data:A}=([m,k]=$(()=>j("taxonomies",()=>I("/taxonomies/"))),m=await m,k(),m);if(!A.value)throw L({statusCode:404,message:"This page could not be found",fatal:!0});const H=C(A.value),U=T(()=>s.value.securityTaxonomies.map(r=>({...r,weight:Number(r.weight),taxonomy:H.value.find(y=>y.uuid===r.taxonomyUuid)}))),v=T(()=>U.value.filter(r=>r.rootTaxonomyUuid==="5b0d5647-a4e6-4db8-807b-c3a6d11697a7")),O=C(),Y=r=>{O.value.toggle(r)},P=T(()=>U.value.filter(r=>r.rootTaxonomyUuid==="072bba7b-ed7a-4cb4-aab3-91520d00fb00")),E=C(),J=r=>{E.value.toggle(r)};re(p,async r=>{c.value=await I(`/securities/uuid/${w.params.uuid}/markets/${r}`,{params:{from:"2000-01-01"}})});async function Q({date:r}){if(await I(`/securities/uuid/${s.value.uuid}/markets/${p.value}/prices/${r}`,{method:"delete"}),c.value){const y=c.value.prices.findIndex(g=>g.date===r);delete c.value.prices[y]}}return ie(()=>{var r;return{title:((r=s.value)==null?void 0:r.name)+" - Portfolio Report"}}),(r,y)=>{const g=_("Button"),x=ue,W=_("Chip"),Z=me,X=pe,h=_("Column"),R=_("DataTable"),B=_("OverlayPanel"),V=_("TabPanel"),q=_("Dropdown"),ee=fe,ae=_("TabView"),te=ce("tooltip");return u(),d("div",_e,[a("div",ye,[a("div",ge,[a("div",be,[a("h2",null,t(e(s).name),1),o(x,{to:r.$route.path},{default:i(()=>[de(o(g,{class:"mt-2 cursor-move w-20rem",icon:"i-carbon-move i-lg",label:"Add to Portfolio Performance"},null,512),[[te,{escape:!0,value:"<h4>Drag and drop!</h4> To add this security in Portfolio Performance, drag and drop it to securities list or statement of assets."},void 0,{right:!0}]])]),_:1},8,["to"])]),a("div",null,[e(s).logoUrl?(u(),d("img",{key:0,src:e(s).logoUrl,style:{"max-width":"100px","max-height":"100px","mix-blend-mode":"multiply"}},null,8,ke)):b("",!0)])]),o(ae,{class:"mt-2"},{default:i(()=>[o(V,{header:"Overview"},{default:i(()=>[a("ul",null,[a("li",null,[n(" ISIN: "),a("b",null,t(e(s).isin),1)]),a("li",null,[n(" WKN: "),a("b",null,t(e(s).wkn),1)]),(u(!0),d(M,null,z(e(f),l=>(u(),d("li",{key:l.marketCode},[n(" Market: "),a("b",null,t(l.name),1),a("ul",null,[a("li",null,[n(" Currency: "),a("b",null,t(l.currencyCode||"-"),1)]),a("li",null,[n(" Symbol: "),a("b",null,t(l.symbol),1)]),a("li",null,[n(" Prices available: "),a("b",null,t(l.firstPriceDate),1),n(" - "),a("b",null,t(l.lastPriceDate),1)])])]))),128)),e(s).symbolXfra?(u(),d("li",he,[n(" Symbol (Frankfurt): "),a("b",null,t(e(s).symbolXfra),1)])):b("",!0),e(s).symbolXnas?(u(),d("li",ve,[n(" Symbol (NASDAQ): "),a("b",null,t(e(s).symbolXnas),1)])):b("",!0),e(s).symbolXnys?(u(),d("li",xe,[n(" Symbol (New York): "),a("b",null,t(e(s).symbolXnys),1)])):b("",!0),a("li",null,[n(" Type: "),o(W,{class:"mx-1 text-sm bg-teal-500 text-white"},{default:i(()=>[n(t(e(s).securityType),1)]),_:1})]),e(s).tags&&e(s).tags.length>0?(u(),d("li",Ce,[n(" Tags: "),(u(!0),d(M,null,z(e(s).tags,l=>(u(),K(Z,{key:l,name:l},null,8,["name"]))),128))])):b("",!0),e(v).length===1&&e(v)[0].taxonomy?(u(),d("li",we,[n(" Country: "),o(X,{country:e(v)[0].taxonomy.code||""},null,8,["country"]),a("b",null,t(e(v)[0].taxonomy.name)+" ("+t(e(v)[0].taxonomy.code)+") ",1)])):e(v).length>1?(u(),d("li",Te,[a("a",{href:"#",onClick:Y},"Countries"),o(B,{ref_key:"countriesOverlay",ref:O,"show-close-icon":!0},{default:i(()=>[o(R,{value:e(v),"sort-field":"weight","sort-order":-1,class:"p-datatable-sm mb-2"},{default:i(()=>[o(h,{field:"weight",header:"Percentage",sortable:!0},{body:i(({data:l})=>[n(t(l.weight)+"%",1)]),_:1}),o(h,{field:"taxonomy.name",header:"Country",sortable:!0},{body:i(({data:l})=>[o(X,{country:l.taxonomy.code},null,8,["country"]),n(" "+t(l.taxonomy.name),1)]),_:1}),o(h,{field:"taxonomy.code",header:"Code",sortable:!0})]),_:1},8,["value"])]),_:1},512)])):b("",!0),e(P).length==1&&e(P)[0].taxonomy?(u(),d("li",Pe,[n(" Industry: "),a("b",null,t(e(P)[0].taxonomy.name),1)])):e(P).length>1?(u(),d("li",De,[a("a",{href:"#",onClick:J},"Industries"),o(B,{ref_key:"industriesOverlay",ref:E,"show-close-icon":!0},{default:i(()=>[o(R,{value:e(P),"sort-field":"weight","sort-order":-1,class:"p-datatable-sm"},{default:i(()=>[o(h,{field:"weight",header:"Percentage",sortable:!0},{body:i(({data:l})=>[n(t(l.weight)+"%",1)]),_:1}),o(h,{field:"taxonomy.name",header:"Country",sortable:!0})]),_:1},8,["value"])]),_:1},512)])):b("",!0)])]),_:1}),o(V,{header:"Prices"},{default:i(()=>[o(q,{id:"market",modelValue:e(p),"onUpdate:modelValue":y[0]||(y[0]=l=>G(p)?p.value=l:null),options:e(f),"option-label":"name","option-value":"marketCode",placeholder:"Please select market"},{option:i(({option:l})=>[n(t(l.name)+" - "+t(l.marketCode),1)]),_:1},8,["modelValue","options"]),e(c)?(u(),d("div",Ne,[a("ul",null,[a("li",null,[n(" Symbol: "),a("b",null,t(e(c).symbol),1)]),a("li",null,[n(" Currency: "),a("b",null,t(e(c).currencyCode||"-"),1)]),a("li",null,[n(" Prices available: "),a("b",null,t(e(c).firstPriceDate),1),n(" - "),a("b",null,t(e(c).lastPriceDate),1)])]),o(ee,{prices:e(c).prices,onDeletePrice:Q},null,8,["prices"])])):b("",!0)]),_:1}),e(s).events&&e(s).events.length>0?(u(),K(V,{key:0,header:"Events"},{default:i(()=>[o(R,{value:e(s).events},{default:i(()=>[o(h,{field:"date",header:"Date"}),o(h,{field:"type",header:"Type",style:{"text-transform":"capitalize"}}),o(h,{header:"..."},{body:i(({data:l})=>[n(t(l.type==="dividend"?l.amount+" "+l.currencyCode:"")+" "+t(l.type==="split"?l.ratio:""),1)]),_:1})]),_:1},8,["value"])]),_:1})):b("",!0)]),_:1})])])}}});export{Fe as default};
