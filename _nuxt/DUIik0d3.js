import O from"./DQG29Bm6.js";import L from"./CNYk7JQd.js";import N from"./9P8LeQei.js";import W from"./00pzBaE0.js";import{_ as F}from"./EhdzK8Ao.js";import S from"./CmyByfQe.js";import R from"./Cpw1LCxf.js";import{a as Y}from"./CHiNJl-4.js";import{u as q}from"./DqfBqBqo.js";import{h as z,r as d,w as E,c as H,l,x as m,m as t,u as o,v as f,J as k,q as y,K as c,L as h,t as i,A as I,i as J,H as K}from"./Dj8eBBZx.js";import{s as P}from"./Bbj-KQyD.js";import{a as j}from"./Cut0UcWU.js";import"./CFj-Od8Y.js";import"./T7UzWOG1.js";import"./CLncZbvQ.js";import"./Dt5fh6fP.js";import"./DUyEM3q-.js";import"./CRZlSIVa.js";import"./DlAUqK2U.js";import"./Cgsm9QlA.js";import"./CIGznWKT.js";import"./NEkz9BgX.js";import"./BFY63otf.js";import"./DFx4YNxV.js";import"./W449YruT.js";import"./eFmDASps.js";import"./Byr1bFkf.js";import"./BzcOQpdq.js";import"./DeEtQ5Oc.js";import"./CPbI0jLB.js";import"./BX4m0m4n.js";import"./b8ODyf5A.js";import"./mBdfaV2K.js";const G={class:"p-buttonset"},M={class:"flex align-items-end",style:{height:"400px"}},Ve=z({__name:"weekly",setup(Q){const n=d(new Date().getFullYear()),w=d();function b(a){w.value.toggle(a)}const _=d(new Date),$=j(_),{data:p,pending:x,refresh:g}=Y(`statsWeeks:${n.value}`,async()=>{const a=await q(`/stats/updates/weeks?year=${n.value}`);for(const e of a)e.firstUpdate&&(e.firstUpdate=new Date(e.firstUpdate)),e.lastUpdate&&(e.lastUpdate=new Date(e.lastUpdate));return _.value=new Date,{weeks:a.sort((e,r)=>e.week-r.week)}});E(n,()=>g());const D=H(()=>{var a,e;return{labels:(a=p.value)==null?void 0:a.weeks.map(r=>r.week),datasets:[{backgroundColor:"#3B82F6",data:(e=p.value)==null?void 0:e.weeks.map(r=>r.count)}]}}),C={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}}};return(a,e)=>{const r=O,U=L,A=N,u=W,B=F,v=S,T=R;return i(),l("div",null,[m("div",G,[t(r,{label:"Versions",icon:"i-carbon-tag",class:"p-button-secondary",onClick:e[0]||(e[0]=s=>("navigateTo"in a?a.navigateTo:o(I))("/stats/"))}),t(r,{label:"Weekly",icon:"i-carbon-calendar",class:"p-button-primary",disabled:!0})]),m("h2",null,[f(" Weekly Statistics for "),m("a",{class:"cursor-pointer",onClick:b},k(o(n)),1)]),t(A,{ref_key:"yearOverlay",ref:w,"show-close-icon":!0},{default:y(()=>[t(U,{modelValue:o(n),"onUpdate:modelValue":e[1]||(e[1]=s=>J(n)?n.value=s:null),"use-grouping":!1},null,8,["modelValue"])]),_:1},512),o(x)||!o(p)?(i(),l(c,{key:0},[t(u,{width:"15em"}),m("div",M,[(i(),l(c,null,h([30,25,45,70,90],(s,V)=>t(u,{key:V,width:"20%",height:`${s}%`,class:"mr-2"},null,8,["height"])),64))]),(i(!0),l(c,null,h(Array(10).keys(),s=>(i(),K(u,{key:s,class:"mt-4"}))),128))],64)):(i(),l(c,{key:1},[f(" Last updated "+k(o($))+" ",1),t(B,{small:"",icon:"i-carbon-renew",onClick:e[2]||(e[2]=s=>o(g)())}),t(o(P),{type:"line",data:o(D),options:C,style:{height:"400px"}},null,8,["data"]),t(T,{value:o(p).weeks,"sort-field":"week",class:"p-datatable-sm font-mono","sort-order":-1},{default:y(()=>[t(v,{field:"week",header:"Week",sortable:!0},{body:y(s=>[f(k(s.data.week),1)]),_:1}),t(v,{field:"count",header:"Count",sortable:!0,class:"text-right"})]),_:1},8,["value"])],64))])}}});export{Ve as default};
