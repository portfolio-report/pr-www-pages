import{d as U,r as p,o as r,c,a as s,w as u,h as w,D as J,L as $,M as B,n as T,j as O,u as W,b as e,t as l,G as v,_ as q,H as Z,K as ee,e as o,I as E,J as F,f as g,F as D}from"./entry.6ddbcc5e.js";import{_ as te}from"./SecurityTag.d1018b9f.js";import{u as R}from"./asyncData.016c481f.js";import{u as C}from"./useApi.01e786c3.js";import"./_plugin-vue_export-helper.a1a6add7.js";const ae=U({__name:"PricesTable",props:{prices:null},setup(P){return(d,h)=>{const f=p("Column"),i=p("DataTable");return r(),c("div",null,[s(i,{value:P.prices,class:"p-datatable-sm",paginator:!0,rows:10,"sort-field":"date","sort-order":-1,"rows-per-page-options":[10,30,100,300]},{default:u(()=>[s(f,{field:"date",header:"Date",sortable:!0}),s(f,{field:"close",header:"Close"})]),_:1},8,["value"])])}}}),le={class:"flex justify-content-center"},oe={style:{width:"800px"}},se={class:"flex flex-wrap"},ne={class:"flex-grow-1"},re=["src"],ue={key:0},ie={key:1},ce={key:2},de={key:3},me={key:0},_e=e("h4",null,"Country",-1),he=U({__name:"[uuid]",async setup(P){let d,h;const f=w(""),i=w(null),k=J(),{data:N,error:I}=([d,h]=$(()=>R(`security:${k.params.uuid}`,()=>C(`/securities/uuid/${k.params.uuid}`))),d=await d,h(),d);if(I.value||!N.value)throw B({statusCode:404,message:"This page could not be found",fatal:!0});const t=w(N.value),S=T(()=>{var n,m;return(m=(n=t.value)==null?void 0:n.markets)==null?void 0:m.map(_=>{let y;return _.marketCode==="XETR"?y="XETRA (Frankfurt)":_.marketCode==="XFRA"?y="Frankfurt":_.marketCode==="XNAS"?y="NASDAQ":_.marketCode==="XNYS"&&(y="NYSE"),{..._,name:y}})}),{data:A}=([d,h]=$(()=>R("taxonomies",()=>C("/taxonomies/"))),d=await d,h(),d);if(!A.value)throw B({statusCode:404,message:"This page could not be found",fatal:!0});const M=w(A.value),L=T(()=>t.value.securityTaxonomies.map(n=>({...n,weight:Number(n.weight),taxonomy:M.value.find(m=>m.uuid===n.taxonomyUuid)}))),X=T(()=>L.value.filter(n=>n.rootTaxonomyUuid==="5b0d5647-a4e6-4db8-807b-c3a6d11697a7"));O(f,async n=>{i.value=await C(`/securities/uuid/${k.params.uuid}/markets/${n}`,{params:{from:"2000-01-01"}})});async function Y({date:n}){if(await C(`/securities/uuid/${t.value.uuid}/markets/${f.value}/prices/${n}`,{method:"delete"}),i.value){const m=i.value.prices.findIndex(_=>_.date===n);delete i.value.prices[m]}}return W(()=>{var n;return{title:((n=t.value)==null?void 0:n.name)+" - Portfolio Report"}}),(n,m)=>{const _=p("Button"),y=q,j=p("Chip"),H=te,x=p("TabPanel"),K=p("Dropdown"),Q=ae,b=p("Column"),V=p("DataTable"),z=p("TabView"),G=Z("tooltip");return r(),c("div",le,[e("div",oe,[e("div",se,[e("div",ne,[e("h2",null,l(t.value.name),1),s(y,{to:n.$route.path},{default:u(()=>[ee(s(_,{class:"mt-2 cursor-move w-20rem",icon:"i-carbon-move i-lg",label:"Add to Portfolio Performance"},null,512),[[G,{escape:!0,value:"<h4>Drag and drop!</h4> To add this security in Portfolio Performance, drag and drop it to securities list or statement of assets."},void 0,{right:!0}]])]),_:1},8,["to"])]),e("div",null,[t.value.logoUrl?(r(),c("img",{key:0,src:t.value.logoUrl,style:{"max-width":"100px","max-height":"100px","mix-blend-mode":"multiply"}},null,8,re)):v("",!0)])]),s(z,{class:"mt-2"},{default:u(()=>[s(x,{header:"Overview"},{default:u(()=>[e("ul",null,[e("li",null,[o(" ISIN: "),e("b",null,l(t.value.isin),1)]),e("li",null,[o(" WKN: "),e("b",null,l(t.value.wkn),1)]),(r(!0),c(E,null,F(g(S),a=>(r(),c("li",{key:a.marketCode},[o(" Market: "),e("b",null,l(a.name),1),e("ul",null,[e("li",null,[o(" Currency: "),e("b",null,l(a.currencyCode||"-"),1)]),e("li",null,[o(" Symbol: "),e("b",null,l(a.symbol),1)]),e("li",null,[o(" Prices available: "),e("b",null,l(a.firstPriceDate),1),o(" - "),e("b",null,l(a.lastPriceDate),1)])])]))),128)),t.value.symbolXfra?(r(),c("li",ue,[o(" Symbol (Frankfurt): "),e("b",null,l(t.value.symbolXfra),1)])):v("",!0),t.value.symbolXnas?(r(),c("li",ie,[o(" Symbol (NASDAQ): "),e("b",null,l(t.value.symbolXnas),1)])):v("",!0),t.value.symbolXnys?(r(),c("li",ce,[o(" Symbol (New York): "),e("b",null,l(t.value.symbolXnys),1)])):v("",!0),e("li",null,[o(" Type: "),s(j,{class:"mx-1 text-sm bg-teal-500 text-white"},{default:u(()=>[o(l(t.value.securityType),1)]),_:1})]),t.value.tags&&t.value.tags.length>0?(r(),c("li",de,[o(" Tags: "),(r(!0),c(E,null,F(t.value.tags,a=>(r(),D(H,{key:a,name:a},null,8,["name"]))),128))])):v("",!0)])]),_:1}),s(x,{header:"Prices"},{default:u(()=>[s(K,{id:"market",modelValue:f.value,"onUpdate:modelValue":m[0]||(m[0]=a=>f.value=a),options:g(S),"option-label":"name","option-value":"marketCode",placeholder:"Please select market"},{option:u(({option:a})=>[o(l(a.name)+" - "+l(a.marketCode),1)]),_:1},8,["modelValue","options"]),i.value?(r(),c("div",me,[e("ul",null,[e("li",null,[o(" Symbol: "),e("b",null,l(i.value.symbol),1)]),e("li",null,[o(" Currency: "),e("b",null,l(i.value.currencyCode||"-"),1)]),e("li",null,[o(" Prices available: "),e("b",null,l(i.value.firstPriceDate),1),o(" - "),e("b",null,l(i.value.lastPriceDate),1)])]),s(Q,{prices:i.value.prices,onDeletePrice:Y},null,8,["prices"])])):v("",!0)]),_:1}),g(X)?(r(),D(x,{key:0,header:"Categories"},{default:u(()=>[_e,s(V,{value:g(X),"sort-field":"weight","sort-order":-1,class:"p-datatable-sm"},{default:u(()=>[s(b,{field:"weight",header:"Percentage",sortable:!0},{body:u(({data:a})=>[o(l(a.weight)+"%",1)]),_:1}),s(b,{field:"taxonomy.name",header:"Country",sortable:!0}),s(b,{field:"taxonomy.code",header:"Code",sortable:!0})]),_:1},8,["value"])]),_:1})):v("",!0),t.value.events&&t.value.events.length>0?(r(),D(x,{key:1,header:"Events"},{default:u(()=>[s(V,{value:t.value.events},{default:u(()=>[s(b,{field:"date",header:"Date"}),s(b,{field:"type",header:"Type",style:{"text-transform":"capitalize"}}),s(b,{header:"..."},{body:u(({data:a})=>[o(l(a.type==="dividend"?a.amount+" "+a.currencyCode:"")+" "+l(a.type==="split"?a.ratio:""),1)]),_:1})]),_:1},8,["value"])]),_:1})):v("",!0)]),_:1})])])}}});export{he as default};
