import{_ as oe}from"./SecurityTag.68493d7c.js";import{h as F,c as C,t as c,m as d,y as le,u as e,r as x,L as ne,l as _,q as n,s as r,v as s,H as l,i as J,C as se,M as G,N as K,w as re,j as ie,E as ce,x as a,I as M,J as j,K as U,F as E,P as ue,G as P,_ as de}from"./entry.951e30f0.js";import{u as H}from"./asyncData.def6e1dd.js";import{u as I}from"./useApi.abf4e740.js";import"./_plugin-vue_export-helper.c27b6911.js";const pe=F({__name:"CountryFlag",props:{country:{}},setup(D){const p=D,v=C(()=>({AR:"i-flagpack-ar",AT:"i-flagpack-at",AU:"i-flagpack-au",BE:"i-flagpack-be",BR:"i-flagpack-br",CA:"i-flagpack-ca",CH:"i-flagpack-ch",CN:"i-flagpack-cn",DE:"i-flagpack-de",DK:"i-flagpack-dk",ES:"i-flagpack-es",FI:"i-flagpack-fi",FR:"i-flagpack-fr",GB:"i-flagpack-gb-ukm",GR:"i-flagpack-gr",IR:"i-flagpack-ie",IN:"i-flagpack-in",IT:"i-flagpack-it",JP:"i-flagpack-jp",KR:"i-flagpack-kr",LI:"i-flagpack-li",LU:"i-flagpack-lu",NL:"i-flagpack-nl",NO:"i-flagpack-no",NZ:"i-flagpack-nz",PL:"i-flagpack-pl",PT:"i-flagpack-pt",RU:"i-flagpack-ru",SE:"i-flagpack-se",SG:"i-flagpack-sg",TR:"i-flagpack-tr",TW:"i-flagpack-tw",US:"i-flagpack-us",VN:"i-flagpack-vn",ZA:"i-flagpack-za"})[p.country]);return(m,u)=>(c(),d("i",{class:le(["ii",e(v)])},null,2))}}),me=F({__name:"PricesTable",props:{prices:{}},setup(D){const p=D,v=C(()=>p.prices.map(u=>({dateStr:u.date,date:new Date(u.date),close:u.close}))),m=x({date:{operator:ne.AND,constraints:[{value:null,matchMode:"dateIs"}]}});return(u,w)=>{const N=_("Calendar"),S=_("Column"),i=_("DataTable");return c(),d("div",null,[n(i,{filters:e(m),"onUpdate:filters":w[0]||(w[0]=f=>J(m)?m.value=f:null),value:e(v),class:"p-datatable-sm",paginator:!0,rows:10,"sort-field":"date","sort-order":-1,"rows-per-page-options":[10,30,100,300],"filter-display":"menu"},{default:r(()=>[n(S,{field:"date",header:"Date",sortable:"","data-type":"date"},{body:r(({data:f})=>[s(l(f.dateStr),1)]),filter:r(({filterModel:f})=>[n(N,{modelValue:f.value,"onUpdate:modelValue":A=>f.value=A,"date-format":"yy-mm-dd",placeholder:"yyyy-mm-dd"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(S,{field:"close",header:"Close"},{body:r(({data:f})=>[s(l(f.close.toLocaleString(void 0,{minimumFractionDigits:2})),1)]),_:1})]),_:1},8,["filters","value"])])}}}),fe={class:"flex justify-content-center"},_e={style:{width:"800px"}},ye={class:"flex flex-wrap"},ge={class:"flex-grow-1"},ve={class:"text-600"},be=a("span",{class:"mt-2 cursor-move w-20rem p-button p-component"},[a("span",{class:"i-carbon-move i-lg p-button-icon p-button-icon-left"}),a("span",{class:"p-button-label"},"Add to Portfolio Performance")],-1),he=["src"],ke={key:0},xe={key:1},we={key:2},Ce={key:3},Te={key:0},Ie=F({__name:"[uuid]",async setup(D){let p,v;const m=x(""),u=x(null),w=se(),{data:N,error:S}=([p,v]=G(()=>H(`security:${w.params.uuid}`,()=>I(`/securities/uuid/${w.params.uuid}`))),p=await p,v(),p);if(S.value||!N.value)throw K({statusCode:404,message:"This page could not be found",fatal:!0});const i=x(N.value),f=C(()=>{var o,y;return(y=(o=i.value)==null?void 0:o.markets)==null?void 0:y.map(g=>{let k;return g.marketCode==="XETR"?k="XETRA (Frankfurt)":g.marketCode==="XFRA"?k="Frankfurt":g.marketCode==="XNAS"?k="NASDAQ":g.marketCode==="XNYS"&&(k="NYSE"),{...g,name:k}})}),{data:A}=([p,v]=G(()=>H("taxonomies",()=>I("/taxonomies/"))),p=await p,v(),p);if(!A.value)throw K({statusCode:404,message:"This page could not be found",fatal:!0});const W=x(A.value),O=C(()=>i.value.securityTaxonomies.map(o=>({...o,weight:Number(o.weight),taxonomy:W.value.find(y=>y.uuid===o.taxonomyUuid)}))),h=C(()=>O.value.filter(o=>o.rootTaxonomyUuid==="5b0d5647-a4e6-4db8-807b-c3a6d11697a7")),L=x();function Y(o){L.value.toggle(o)}const T=C(()=>O.value.filter(o=>o.rootTaxonomyUuid==="072bba7b-ed7a-4cb4-aab3-91520d00fb00")),B=x();function Z(o){B.value.toggle(o)}re(m,async o=>{u.value=await I(`/securities/uuid/${w.params.uuid}/markets/${o}`,{params:{from:"2000-01-01"}})});async function q({date:o}){if(await I(`/securities/uuid/${i.value.uuid}/markets/${m.value}/prices/${o}`,{method:"delete"}),u.value){const y=u.value.prices.findIndex(g=>g.date===o);delete u.value.prices[y]}}return ie(()=>{var o;return{title:`${(o=i.value)==null?void 0:o.name} - Portfolio Report`,link:[{rel:"canonical",href:`https://www.portfolio-report.net/securities/${i.value.uuid}`}]}}),(o,y)=>{const g=_("Tag"),k=oe,Q=de,X=pe,b=_("Column"),R=_("DataTable"),z=_("OverlayPanel"),$=_("TabPanel"),ee=_("Dropdown"),ae=me,te=_("TabView"),V=ce("tooltip");return c(),d("div",fe,[a("div",_e,[a("div",ye,[a("div",ge,[a("h2",null,[s(l(e(i).name)+" ",1),n(g,{class:"mx-1 bg-teal-500 vertical-align-top"},{default:r(()=>[s(l(e(i).securityType),1)]),_:1}),(c(!0),d(M,null,j(e(i).tags,t=>(c(),E(k,{key:t,class:"vertical-align-top",name:t},null,8,["name"]))),128))]),a("div",ve,[U((c(),d("span",null,[s(l(e(i).isin),1)])),[[V,"ISIN",void 0,{top:!0}]]),s(" Â· "),U((c(),d("span",null,[s(l(e(i).wkn),1)])),[[V,"WKN",void 0,{top:!0}]])]),U((c(),E(Q,{to:(o._.provides[ue]||o.$route).path},{default:r(()=>[be]),_:1},8,["to"])),[[V,{escape:!0,value:"<h4>Drag and drop!</h4> To add this security in Portfolio Performance, drag and drop it to securities list or statement of assets."},void 0,{right:!0}]])]),a("div",null,[e(i).logoUrl?(c(),d("img",{key:0,src:e(i).logoUrl,style:{"max-width":"100px","max-height":"100px","mix-blend-mode":"multiply"}},null,8,he)):P("",!0)])]),n(te,{class:"mt-2"},{default:r(()=>[n($,{header:"Overview"},{default:r(()=>[a("ul",null,[(c(!0),d(M,null,j(e(f),t=>(c(),d("li",{key:t.marketCode},[s(" Market: "),a("b",null,l(t.name),1),a("ul",null,[a("li",null,[s(" Currency: "),a("b",null,l(t.currencyCode||"-"),1)]),a("li",null,[s(" Symbol: "),a("b",null,l(t.symbol),1)]),a("li",null,[s(" Prices available: "),a("b",null,l(t.firstPriceDate),1),s(" - "),a("b",null,l(t.lastPriceDate),1)])])]))),128)),e(h).length===1&&e(h)[0].taxonomy?(c(),d("li",ke,[s(" Country: "),n(X,{country:e(h)[0].taxonomy.code||""},null,8,["country"]),a("b",null,l(e(h)[0].taxonomy.name)+" ("+l(e(h)[0].taxonomy.code)+") ",1)])):e(h).length>1?(c(),d("li",xe,[a("a",{href:"#",onClick:Y},"Countries"),n(z,{ref_key:"countriesOverlay",ref:L,"show-close-icon":!0},{default:r(()=>[n(R,{value:e(h),"sort-field":"weight","sort-order":-1,class:"p-datatable-sm mb-2"},{default:r(()=>[n(b,{field:"weight",header:"Percentage",sortable:!0},{body:r(({data:t})=>[s(l(t.weight)+"% ",1)]),_:1}),n(b,{field:"taxonomy.name",header:"Country",sortable:!0},{body:r(({data:t})=>[n(X,{country:t.taxonomy.code},null,8,["country"]),s(" "+l(t.taxonomy.name),1)]),_:1}),n(b,{field:"taxonomy.code",header:"Code",sortable:!0})]),_:1},8,["value"])]),_:1},512)])):P("",!0),e(T).length===1&&e(T)[0].taxonomy?(c(),d("li",we,[s(" Industry: "),a("b",null,l(e(T)[0].taxonomy.name),1)])):e(T).length>1?(c(),d("li",Ce,[a("a",{href:"#",onClick:Z},"Industries"),n(z,{ref_key:"industriesOverlay",ref:B,"show-close-icon":!0},{default:r(()=>[n(R,{value:e(T),"sort-field":"weight","sort-order":-1,class:"p-datatable-sm"},{default:r(()=>[n(b,{field:"weight",header:"Percentage",sortable:!0},{body:r(({data:t})=>[s(l(t.weight)+"% ",1)]),_:1}),n(b,{field:"taxonomy.name",header:"Country",sortable:!0})]),_:1},8,["value"])]),_:1},512)])):P("",!0)])]),_:1}),n($,{header:"Prices"},{default:r(()=>[n(ee,{modelValue:e(m),"onUpdate:modelValue":y[0]||(y[0]=t=>J(m)?m.value=t:null),options:e(f),"option-label":"name","option-value":"marketCode",placeholder:"Please select market"},{option:r(({option:t})=>[s(l(t.name)+" - "+l(t.marketCode),1)]),_:1},8,["modelValue","options"]),e(u)?(c(),d("div",Te,[a("ul",null,[a("li",null,[s(" Symbol: "),a("b",null,l(e(u).symbol),1)]),a("li",null,[s(" Currency: "),a("b",null,l(e(u).currencyCode||"-"),1)]),a("li",null,[s(" Prices available: "),a("b",null,l(e(u).firstPriceDate),1),s(" - "),a("b",null,l(e(u).lastPriceDate),1)])]),n(ae,{prices:e(u).prices,onDeletePrice:q},null,8,["prices"])])):P("",!0)]),_:1}),e(i).events&&e(i).events.length>0?(c(),E($,{key:0,header:"Events"},{default:r(()=>[n(R,{value:e(i).events},{default:r(()=>[n(b,{field:"date",header:"Date"}),n(b,{field:"type",header:"Type",style:{"text-transform":"capitalize"}}),n(b,{header:"..."},{body:r(({data:t})=>[s(l(t.type==="dividend"?`${t.amount} ${t.currencyCode}`:"")+" "+l(t.type==="split"?t.ratio:""),1)]),_:1})]),_:1},8,["value"])]),_:1})):P("",!0)]),_:1})])])}}});export{Ie as default};
