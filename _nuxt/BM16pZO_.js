import{_ as V}from"./C9HHmnGw.js";import{q as D,c as $,Q as _,u as e,r as F,j as p,x as a,y as n,A as x,S as d,U as g,z as U,h as i,G as I,F as L,_ as N}from"./BehrpsNf.js";import{u as Y}from"./BHzSDvGZ.js";import{c as z,a as c,b as S}from"./KT6I8xft.js";import{u as H}from"./CevOhGvR.js";import{a as M}from"./BLzm2-SU.js";import{a as k}from"./DMdha5Nw.js";import{s as W,a as f}from"./BGvAm4IU.js";import{s as j}from"./Pg3tZCCP.js";import"./DlAUqK2U.js";import"./YWNEA-SD.js";import"./y2NmtJYJ.js";const q=D({__name:"Date",props:{value:{}},setup(v){const u=v,m=$(()=>new Date(u.value)),r=Y(m.value,"YYYY-MM-DD HH:mm:ss");return(y,b)=>_(e(r))}}),E={class:"flex items-end",style:{height:"400px"}},st=D({__name:"index",setup(v){const u=F(new Date),m=M(u),{data:r,refresh:y,status:b}=z(async()=>{const o=await H("/stats/updates");for(const t of o)t.firstUpdate&&(t.firstUpdate=new Date(t.firstUpdate),t.firstUpdateInt=t.firstUpdate.getTime()),t.lastUpdate&&(t.lastUpdate=new Date(t.lastUpdate),t.lastUpdateInt=t.lastUpdate.getTime());return u.value=new Date,{versions:o}},"$AU7PyxXx3W"),w=$(()=>{var o,t;return{labels:(o=r.value)==null?void 0:o.versions.map(l=>l.version),datasets:[{backgroundColor:"#3B82F6",data:(t=r.value)==null?void 0:t.versions.map(l=>l.count)}]}}),A={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}}};function T(o){L(o)}return(o,t)=>{const l=V,B=N,h=q;return i(),p("div",null,[a(e(W),null,{default:n(()=>[a(e(k),{label:"Versions",icon:"i-carbon-tag",class:"p-button-primary",disabled:!0}),a(e(k),{label:"Weekly",icon:"i-carbon-calendar",class:"p-button-secondary",onClick:t[0]||(t[0]=s=>T("/stats/weekly"))})]),_:1}),t[2]||(t[2]=x("h2",null,"Version Statistics",-1)),e(b)==="pending"||!e(r)?(i(),p(d,{key:0},[a(e(f),{width:"15em"}),x("div",E,[(i(),p(d,null,g([30,25,45,70,90],(s,C)=>a(e(f),{key:C,width:"20%",height:`${s}%`,class:"mr-2"},null,8,["height"])),64))]),(i(!0),p(d,null,g(Array(10).keys(),s=>(i(),I(e(f),{key:s,class:"mt-4"}))),128))],64)):(i(),p(d,{key:1},[U(" Last updated "+_(e(m))+" ",1),a(l,{small:"",icon:"i-carbon-renew",onClick:t[1]||(t[1]=s=>e(y)())}),a(e(j),{type:"bar",data:e(w),options:A,style:{height:"400px"}},null,8,["data"]),a(e(S),{value:e(r).versions,"sort-field":"version",class:"font-mono",size:"small","sort-order":-1},{default:n(()=>[a(e(c),{field:"version",header:"Version",sortable:!0},{body:n(({data:s})=>[a(B,{to:`/stats/${s.version}`,class:"text-blue-500"},{default:n(()=>[U(_(s.version),1)]),_:2},1032,["to"])]),_:1}),a(e(c),{field:"firstUpdateInt",header:"From",sortable:!0},{body:n(s=>[a(h,{value:s.data.firstUpdate},null,8,["value"])]),_:1}),a(e(c),{field:"lastUpdateInt",header:"To",sortable:!0},{body:n(s=>[a(h,{value:s.data.lastUpdate},null,8,["value"])]),_:1}),a(e(c),{field:"count",header:"Count",sortable:!0,class:"!text-right"})]),_:1},8,["value"])],64))])}}});export{st as default};
