import{u as te,a as oe,_ as ae}from"./useConfirmDialog.6475ab43.js";import{_ as le}from"./IconLink.8540b2f9.js";import{d as Y,P as j,r as h,o as i,c as _,a as s,w as r,n as f,m as x,k as m,i as C,f as se,g as U,h as F,j as N,B as ne,u as ie,b as e,e as l,t as a,_ as ue,R as re,S as ce,F as R,l as L,q as S}from"./entry.a7bc077a.js";import{_ as de}from"./SecurityTag.c8be354c.js";import{u as M}from"./asyncData.7baf762a.js";import{_ as _e}from"./SecurityDialog.vue_vue_type_script_setup_true_lang.ae420093.js";import"./TextBtn.a9984eb9.js";import"./_plugin-vue_export-helper.a1a6add7.js";import"./AcceptBtn.vue_vue_type_script_setup_true_lang.da3c2973.js";const me=Y({__name:"PricesTable",props:{prices:null},emits:["deletePrice"],setup(A,{emit:p}){const b=j(),g=te();async function c(y){await g({message:`Are you sure you want to delete the price of ${y.date}?`,header:"Delete price",icon:"i-carbon-warning"})&&p("deletePrice",{date:y.date})}return(y,D)=>{const w=h("Column"),$=oe,t=h("DataTable");return i(),_("div",null,[s(t,{value:A.prices,class:"p-datatable-sm",paginator:!0,rows:10,"rows-per-page-options":[10,30,100,300]},{default:r(()=>[s(w,{field:"date",header:"Date",sortable:!0}),s(w,{field:"close",header:"Close"}),f(b).loggedIn?(i(),x(w,{key:0,style:{"min-width":"8rem"}},{body:r(T=>[s($,{onClick:X=>c(T.data)},null,8,["onClick"])]),_:1})):m("",!0)]),_:1},8,["value"])])}}}),pe={class:"flex justify-content-center"},he={style:{width:"800px"}},fe={class:"flex flex-wrap"},ye={class:"flex-grow-1"},ve=["src"],be={key:0},ge=l(" UUID: "),we=l(" ISIN: "),ke=l(" WKN: "),xe=l(" Market: "),Ce=l(" Currency: "),De=l(" Symbol: "),Te=l(" Prices available: "),Pe=l(" - "),Se={key:1},$e=l(" Symbol (Frankfurt): "),Ne={key:2},Ae=l(" Symbol (NASDAQ): "),Xe={key:3},Be=l(" Symbol (New York): "),Ie=l(" Type: "),Ve={key:4},Ee=l(" Tags: "),Ue={key:0},Fe=l(" Symbol: "),Re=l(" Currency: "),Le=l(" Prices available: "),Me=l(" - "),Ye=e("h4",null,"Country",-1),Je=Y({__name:"[uuid]",async setup(A){let p,b;const g=C(""),c=C(null),y=se(),D=j(),{data:w,error:$}=([p,b]=U(()=>M(`security:${y.params.uuid}`,()=>S(`/securities/uuid/${y.params.uuid}`))),p=await p,b(),p);if($.value||!w.value)throw F({statusCode:404,message:"This page could not be found",fatal:!0});const t=C(w.value),T=C(null);async function X(n){var d;const u=await((d=T.value)==null?void 0:d.show(n));u&&(t.value={...t.value,...u})}const B=N(()=>{var n,u;return(u=(n=t.value)==null?void 0:n.markets)==null?void 0:u.map(d=>{let v;return d.marketCode==="XETR"?v="XETRA (Frankfurt)":d.marketCode==="XFRA"?v="Frankfurt":d.marketCode==="XNAS"?v="NASDAQ":d.marketCode==="XNYS"&&(v="NYSE"),{...d,name:v}})}),{data:I}=([p,b]=U(()=>M("taxonomies",()=>S("/taxonomies/"))),p=await p,b(),p);if(!I.value)throw F({statusCode:404,message:"This page could not be found",fatal:!0});const Q=C(I.value),q=N(()=>t.value.securityTaxonomies.map(n=>({...n,weight:Number(n.weight),taxonomy:Q.value.find(u=>u.uuid===n.taxonomyUuid)}))),V=N(()=>q.value.filter(n=>n.rootTaxonomyUuid==="5b0d5647-a4e6-4db8-807b-c3a6d11697a7"));ne(g,async n=>{c.value=await S(`/securities/uuid/${y.params.uuid}/markets/${n}`,{params:{from:"2000-01-01"}})});async function z({date:n}){if(await S(`/securities/uuid/${t.value.uuid}/markets/${g.value}/prices/${n}`,{method:"delete"}),c.value){const u=c.value.prices.findIndex(d=>d.date===n);delete c.value.prices[u]}}return ie(()=>{var n;return{title:((n=t.value)==null?void 0:n.name)+" - Portfolio Report"}}),(n,u)=>{const d=ae,v=le,H=h("Button"),K=ue,O=h("Chip"),W=de,P=h("TabPanel"),G=h("Dropdown"),J=me,k=h("Column"),E=h("DataTable"),Z=h("TabView"),ee=re("tooltip");return i(),_("div",pe,[e("div",he,[e("div",fe,[e("div",ye,[e("h2",null,[l(a(t.value.name)+" ",1),f(D).loggedIn?(i(),x(d,{key:0,onClick:u[0]||(u[0]=o=>X(t.value))})):m("",!0),f(D).loggedIn?(i(),x(v,{key:1,icon:"i-carbon-unlocked",to:`/admin/securities/${t.value.uuid}`},null,8,["to"])):m("",!0)]),s(K,{to:n.$route.path},{default:r(()=>[ce(s(H,{class:"mt-2 cursor-move w-20rem",icon:"i-carbon-move i-lg",label:"Add to Portfolio Performance"},null,512),[[ee,{escape:!0,value:"<h4>Drag and drop!</h4> To add this security in Portfolio Performance, drag and drop it to securities list or statement of assets."},void 0,{right:!0}]])]),_:1},8,["to"])]),t.value.logoUrl?(i(),_("img",{key:0,src:t.value.logoUrl,style:{"max-width":"100px","max-height":"100px","mix-blend-mode":"multiply"}},null,8,ve)):m("",!0)]),s(Z,{class:"mt-2"},{default:r(()=>[s(P,{header:"Overview"},{default:r(()=>[e("ul",null,[f(D).loggedIn?(i(),_("li",be,[ge,e("b",null,a(t.value.uuid),1)])):m("",!0),e("li",null,[we,e("b",null,a(t.value.isin),1)]),e("li",null,[ke,e("b",null,a(t.value.wkn),1)]),(i(!0),_(R,null,L(f(B),o=>(i(),_("li",{key:o.marketCode},[xe,e("b",null,a(o.name),1),e("ul",null,[e("li",null,[Ce,e("b",null,a(o.currencyCode||"-"),1)]),e("li",null,[De,e("b",null,a(o.symbol),1)]),e("li",null,[Te,e("b",null,a(o.firstPriceDate),1),Pe,e("b",null,a(o.lastPriceDate),1)])])]))),128)),t.value.symbolXfra?(i(),_("li",Se,[$e,e("b",null,a(t.value.symbolXfra),1)])):m("",!0),t.value.symbolXnas?(i(),_("li",Ne,[Ae,e("b",null,a(t.value.symbolXnas),1)])):m("",!0),t.value.symbolXnys?(i(),_("li",Xe,[Be,e("b",null,a(t.value.symbolXnys),1)])):m("",!0),e("li",null,[Ie,s(O,{class:"mx-1 text-sm bg-teal-500 text-white"},{default:r(()=>[l(a(t.value.securityType),1)]),_:1})]),t.value.tags&&t.value.tags.length>0?(i(),_("li",Ve,[Ee,(i(!0),_(R,null,L(t.value.tags,o=>(i(),x(W,{key:o,name:o},null,8,["name"]))),128))])):m("",!0)])]),_:1}),s(P,{header:"Prices"},{default:r(()=>[s(G,{id:"market",modelValue:g.value,"onUpdate:modelValue":u[1]||(u[1]=o=>g.value=o),options:f(B),"option-label":"name","option-value":"marketCode",placeholder:"Please select market"},{option:r(({option:o})=>[l(a(o.name)+" - "+a(o.marketCode),1)]),_:1},8,["modelValue","options"]),c.value?(i(),_("div",Ue,[e("ul",null,[e("li",null,[Fe,e("b",null,a(c.value.symbol),1)]),e("li",null,[Re,e("b",null,a(c.value.currencyCode||"-"),1)]),e("li",null,[Le,e("b",null,a(c.value.firstPriceDate),1),Me,e("b",null,a(c.value.lastPriceDate),1)])]),s(J,{prices:c.value.prices,onDeletePrice:z},null,8,["prices"])])):m("",!0)]),_:1}),f(V)?(i(),x(P,{key:0,header:"Categories"},{default:r(()=>[Ye,s(E,{value:f(V),"sort-field":"weight","sort-order":-1,class:"p-datatable-sm"},{default:r(()=>[s(k,{field:"weight",header:"Percentage",sortable:!0},{body:r(({data:o})=>[l(a(o.weight)+"%",1)]),_:1}),s(k,{field:"taxonomy.name",header:"Country",sortable:!0}),s(k,{field:"taxonomy.code",header:"Code",sortable:!0})]),_:1},8,["value"])]),_:1})):m("",!0),t.value.events&&t.value.events.length>0?(i(),x(P,{key:1,header:"Events"},{default:r(()=>[s(E,{value:t.value.events},{default:r(()=>[s(k,{field:"date",header:"Date"}),s(k,{field:"type",header:"Type",style:{"text-transform":"capitalize"}}),s(k,{header:"..."},{body:r(({data:o})=>[l(a(o.type==="dividend"?o.amount+" "+o.currencyCode:"")+" "+a(o.type==="split"?o.ratio:""),1)]),_:1})]),_:1},8,["value"])]),_:1})):m("",!0)]),_:1})]),s(_e,{ref_key:"securityDialog",ref:T},null,512)])}}});export{Je as default};
