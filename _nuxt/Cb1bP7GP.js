import N from"./3SOQVxAJ.js";import O from"./BkDmKJN7.js";import W from"./Xq7EHWrm.js";import F from"./2PH0Qjnk.js";import{_ as L}from"./DkXKAC7c.js";import S from"./Be9q5SZf.js";import z from"./CiO7LkK_.js";import{a as I}from"./GO8DQxNM.js";import{u as R}from"./vlyglVPv.js";import{h as Y,r as f,w as q,c as E,l,x as m,m as e,u as o,v as k,G as y,q as g,H as c,I as b,t as i,A as G,i as H,B as P}from"./D6mipjrG.js";import{s as j}from"./CJ_tfikf.js";import{a as J}from"./B-h3hNH2.js";import"./Bknz_VtK.js";import"./Birl-_gt.js";import"./CNHgLxVY.js";import"./C5ANAZnY.js";import"./CSRQPzFw.js";import"./CwrO0xPP.js";import"./DiRcQFX5.js";import"./DlAUqK2U.js";import"./DKBq0S5a.js";import"./UCOPYYAg.js";import"./CfPfvlhD.js";import"./wLZgfX0z.js";import"./CSxR6FWU.js";import"./UfJyw5R0.js";import"./D7Bxf2hc.js";import"./BlZmvWzY.js";import"./CzMSzpAA.js";import"./BsV5Mnon.js";import"./BgMnCtTV.js";import"./5bTUVv95.js";import"./kcNPw_wF.js";import"./BflygEWf.js";import"./CuBf7XCA.js";import"./DtLwe8FV.js";import"./B0iUCgwM.js";import"./jbolflh4.js";const K={class:"p-buttonset"},M={class:"flex items-end",style:{height:"400px"}},Lt=Y({__name:"weekly",setup(Q){const n=f(new Date().getFullYear()),u=f();function h(a){u.value.toggle(a)}const w=f(new Date),x=J(w),{data:p,pending:$,refresh:_}=I(`statsWeeks:${n.value}`,async()=>{const a=await R(`/stats/updates/weeks?year=${n.value}`);for(const t of a)t.firstUpdate&&(t.firstUpdate=new Date(t.firstUpdate)),t.lastUpdate&&(t.lastUpdate=new Date(t.lastUpdate));return w.value=new Date,{weeks:a.sort((t,r)=>t.week-r.week)}});q(n,()=>_());const C=E(()=>{var a,t;return{labels:(a=p.value)==null?void 0:a.weeks.map(r=>r.week),datasets:[{backgroundColor:"#3B82F6",data:(t=p.value)==null?void 0:t.weeks.map(r=>r.count)}]}}),D={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}}};return(a,t)=>{const r=N,B=O,U=W,d=F,A=L,v=S,T=z;return i(),l("div",null,[m("div",K,[e(r,{label:"Versions",icon:"i-carbon-tag",class:"p-button-secondary",onClick:t[0]||(t[0]=s=>("navigateTo"in a?a.navigateTo:o(G))("/stats/"))}),e(r,{label:"Weekly",icon:"i-carbon-calendar",class:"p-button-primary",disabled:!0})]),m("h2",null,[k(" Weekly Statistics for "),m("a",{class:"cursor-pointer text-blue-500",onClick:h},y(o(n)),1)]),e(U,{ref_key:"yearOverlay",ref:u},{default:g(()=>[e(r,{icon:"i-carbon-close-large",rounded:"","icon-class":"text-xl",class:"position-absolute top-0 right-0 transform translate-x-1/2 -translate-y-1/2",onClick:t[1]||(t[1]=s=>o(u).hide())}),e(B,{modelValue:o(n),"onUpdate:modelValue":t[2]||(t[2]=s=>H(n)?n.value=s:null),"use-grouping":!1},null,8,["modelValue"])]),_:1},512),o($)||!o(p)?(i(),l(c,{key:0},[e(d,{width:"15em"}),m("div",M,[(i(),l(c,null,b([30,25,45,70,90],(s,V)=>e(d,{key:V,width:"20%",height:`${s}%`,class:"mr-2"},null,8,["height"])),64))]),(i(!0),l(c,null,b(Array(10).keys(),s=>(i(),P(d,{key:s,class:"mt-4"}))),128))],64)):(i(),l(c,{key:1},[k(" Last updated "+y(o(x))+" ",1),e(A,{small:"",icon:"i-carbon-renew",onClick:t[3]||(t[3]=s=>o(_)())}),e(o(j),{type:"line",data:o(C),options:D,style:{height:"400px"}},null,8,["data"]),e(T,{value:o(p).weeks,"sort-field":"week",class:"font-mono",size:"small","sort-order":-1},{default:g(()=>[e(v,{field:"week",header:"Week",sortable:!0},{body:g(s=>[k(y(s.data.week),1)]),_:1}),e(v,{field:"count",header:"Count",sortable:!0,class:"!text-right"})]),_:1},8,["value"])],64))])}}});export{Lt as default};
