import{_ as L}from"./AddBtn.vue_vue_type_script_setup_true_lang.3ba9e636.js";import{u as M,_ as z,a as G,b as J}from"./useConfirmDialog.31f1e694.js";import{_ as K}from"./AcceptBtn.vue_vue_type_script_setup_true_lang.9a15dca9.js";import{d as O,u as Q,f as W,i as D,g as X,h as Y,j as $,o as g,c as Z,b as l,t as ee,n as p,a as e,w as u,r as d,m as oe,k as ae,p as te,q as _}from"./entry.e3a1847c.js";import{u as ne}from"./asyncData.5b448ef3.js";import"./TextBtn.46731ebc.js";import"./_plugin-vue_export-helper.a1a6add7.js";const le={class:"flex align-items-center"},se={class:"m-0 flex-grow-1"},ue=["onSubmit"],de={class:"p-float-label mt-4"},ie=l("label",{for:"name"},"Name",-1),me={class:"p-float-label mt-4"},re=l("label",{for:"code"},"Code",-1),ce={class:"p-float-label mt-4"},fe=l("label",{for:"parent"},"Parent",-1),pe={class:"flex"},_e={class:"flex-grow-1 flex"},Ue=O({__name:"[uuid]",async setup(ve){let v,y;Q({title:"Portfolio Report Admin"});const x=W(),V=M(),i=D(!1),a=D({name:"",code:""}),{data:h,error:k}=([v,y]=X(()=>ne(`taxonomy:${x.params.uuid}`,()=>_(`/taxonomies/${x.params.uuid}`))),v=await v,y(),v);if(k.value)throw Y({statusCode:404,message:"This page could not be found",fatal:!0});const m=$(()=>h.value||{uuid:"",name:"",descendants:[]}),B=$(()=>m.value.uuid?w(m.value.uuid):[]);function w(r){var n,f,b;const o=[],c=(n=m.value)==null?void 0:n.descendants.filter(s=>s.parentUuid===r);for(const s of c!=null?c:[])o.push({key:s.uuid,label:(f=s.name)!=null?f:void 0,data:s,children:w((b=s.uuid)!=null?b:"")});return o}async function C(){h.value=await _(`/taxonomies/${x.params.uuid}`)}function A(){a.value={name:"",code:""},i.value=!0}function T(r){a.value={...r},i.value=!0}async function N(){a.value.uuid?await _(`/taxonomies/${a.value.uuid}`,{method:"put",body:a.value}):await _("/taxonomies/",{method:"post",body:a.value}),C(),i.value=!1}async function I(r){await V({message:`Are you sure you want to delete "${r.name}"?`})&&(await _(`/taxonomies/${r.uuid}`,{method:"delete"}),C()),i.value=!1}return(r,o)=>{const c=L,n=d("Column"),f=z,b=d("TreeTable"),s=d("TabPanel"),P=d("DataTable"),S=d("TabView"),U=d("InputText"),E=d("Dropdown"),R=G,F=J,j=K,q=d("Dialog");return g(),Z("div",null,[l("div",le,[l("h5",se,"Taxonomy: "+ee(p(m).name),1),e(c,{onClick:A})]),e(S,null,{default:u(()=>[e(s,{header:"Tree"},{default:u(()=>[e(b,{value:p(B),class:"p-treetable-sm"},{default:u(()=>[e(n,{field:"name",header:"Name",expander:!0}),e(n,{field:"code",header:"Code"}),e(n,{field:"uuid",header:"UUID"}),e(n,null,{body:u(({node:t})=>[e(f,{onClick:H=>T(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])]),_:1}),e(s,{header:"List"},{default:u(()=>[e(P,{value:p(m).descendants,headers:[{text:"Name",value:"name"},{text:"Code",value:"code"},{text:"UUID",value:"uuid"},{text:"parentUuid",value:"parentUuid"},{value:"actions"}],class:"p-datatable-sm"},{default:u(()=>[e(n,{field:"name",header:"Name",sortable:!0}),e(n,{field:"code",header:"Code",sortable:!0}),e(n,{field:"uuid",header:"UUID",sortable:!0}),e(n,{field:"parentUuid",header:"Parent UUID",sortable:!0}),e(n,null,{body:u(({data:t})=>[e(f,{onClick:H=>T(t)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(q,{visible:i.value,"onUpdate:visible":o[5]||(o[5]=t=>i.value=t),style:{width:"500px"},modal:!0},{footer:u(()=>[l("div",pe,[l("div",_e,[a.value.uuid?(g(),oe(R,{key:0,label:"Delete",onClick:o[3]||(o[3]=t=>I(a.value))})):ae("",!0)]),e(F,{label:"Cancel",onClick:o[4]||(o[4]=t=>i.value=!1)}),e(j,{type:"submit",form:"editTaxonomyForm",label:"Save"})])]),default:u(()=>[l("form",{id:"editTaxonomyForm",onSubmit:te(N,["prevent"])},[l("div",de,[e(U,{id:"name",modelValue:a.value.name,"onUpdate:modelValue":o[0]||(o[0]=t=>a.value.name=t),class:"w-full"},null,8,["modelValue"]),ie]),l("div",me,[e(U,{id:"code",modelValue:a.value.code,"onUpdate:modelValue":o[1]||(o[1]=t=>a.value.code=t),class:"w-full"},null,8,["modelValue"]),re]),l("div",ce,[e(E,{id:"parent",modelValue:a.value.parentUuid,"onUpdate:modelValue":o[2]||(o[2]=t=>a.value.parentUuid=t),"option-label":"name","option-value":"uuid",options:[p(m),...p(m).descendants],class:"w-full"},null,8,["modelValue","options"]),fe])],40,ue)]),_:1},8,["visible"])])}}});export{Ue as default};
