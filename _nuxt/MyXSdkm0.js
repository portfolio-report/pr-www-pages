import{_ as V}from"./CDcp_kVC.js";import{q as k,h as D,W as _,u as t,a as F,c as p,x as a,y as r,X as d,A as $,Y as x,z as g,o as i,G as Y,F as I,_ as L}from"./CLqlgb0A.js";import{u as N}from"./Cg9LFP-8.js";import{c as z,a as u,b as W}from"./aSjnQD4k.js";import{u as H}from"./BszZYmCY.js";import{a as U}from"./APCw35u6.js";import{s as M,a as f}from"./g5-OQd2i.js";import{s as S}from"./C-VHcy8A.js";import{a as X}from"./udedyywi.js";import"./DlAUqK2U.js";import"./BnBfCPwC.js";const q=k({__name:"Date",props:{value:{}},setup(v){const c=v,m=D(()=>new Date(c.value)),n=N(m.value,"YYYY-MM-DD HH:mm:ss");return(y,h)=>_(t(n))}}),E=$("h2",null,"Version Statistics",-1),G={class:"flex items-end",style:{height:"400px"}},st=k({__name:"index",setup(v){const c=F(new Date),m=X(c),{data:n,pending:y,refresh:h}=z(async()=>{const o=await H("/stats/updates");for(const e of o)e.firstUpdate&&(e.firstUpdate=new Date(e.firstUpdate),e.firstUpdateInt=e.firstUpdate.getTime()),e.lastUpdate&&(e.lastUpdate=new Date(e.lastUpdate),e.lastUpdateInt=e.lastUpdate.getTime());return c.value=new Date,{versions:o}},"$AU7PyxXx3W"),w=D(()=>{var o,e;return{labels:(o=n.value)==null?void 0:o.versions.map(l=>l.version),datasets:[{backgroundColor:"#3B82F6",data:(e=n.value)==null?void 0:e.versions.map(l=>l.count)}]}}),A={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}}};function T(o){I(o)}return(o,e)=>{const l=V,B=L,b=q;return i(),p("div",null,[a(t(M),null,{default:r(()=>[a(t(U),{label:"Versions",icon:"i-carbon-tag",class:"p-button-primary",disabled:!0}),a(t(U),{label:"Weekly",icon:"i-carbon-calendar",class:"p-button-secondary",onClick:e[0]||(e[0]=s=>T("/stats/weekly"))})]),_:1}),E,t(y)||!t(n)?(i(),p(d,{key:0},[a(t(f),{width:"15em"}),$("div",G,[(i(),p(d,null,x([30,25,45,70,90],(s,C)=>a(t(f),{key:C,width:"20%",height:`${s}%`,class:"mr-2"},null,8,["height"])),64))]),(i(!0),p(d,null,x(Array(10).keys(),s=>(i(),Y(t(f),{key:s,class:"mt-4"}))),128))],64)):(i(),p(d,{key:1},[g(" Last updated "+_(t(m))+" ",1),a(l,{small:"",icon:"i-carbon-renew",onClick:e[1]||(e[1]=s=>t(h)())}),a(t(S),{type:"bar",data:t(w),options:A,style:{height:"400px"}},null,8,["data"]),a(t(W),{value:t(n).versions,"sort-field":"version",class:"font-mono",size:"small","sort-order":-1},{default:r(()=>[a(t(u),{field:"version",header:"Version",sortable:!0},{body:r(({data:s})=>[a(B,{to:`/stats/${s.version}`,class:"text-blue-500"},{default:r(()=>[g(_(s.version),1)]),_:2},1032,["to"])]),_:1}),a(t(u),{field:"firstUpdateInt",header:"From",sortable:!0},{body:r(s=>[a(b,{value:s.data.firstUpdate},null,8,["value"])]),_:1}),a(t(u),{field:"lastUpdateInt",header:"To",sortable:!0},{body:r(s=>[a(b,{value:s.data.lastUpdate},null,8,["value"])]),_:1}),a(t(u),{field:"count",header:"Count",sortable:!0,class:"!text-right"})]),_:1},8,["value"])],64))])}}});export{st as default};
